exports.id=813,exports.ids=[813],exports.modules={32321:(a,b,c)=>{Promise.resolve().then(c.bind(c,63269))},37968:(a,b,c)=>{"use strict";c.d(b,{Q:()=>t});var d=c(4460),e=c(36341),f=c(36332),g=c(32302),h=c(88196),i=c(39445),j=c(10492),k=c(62765),l=c(36748),m=c(87206),n=c(76751),o=c(55071),p=c(31662),q=c(93709),r=c(25124);let s=async()=>null,t=({onSuccess:a,onLoginSuccess:b,onLogin:c})=>{let[t,u]=(0,e.useState)("email"),[v,w]=(0,e.useState)(""),[x,y]=(0,e.useState)(""),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(0),[D,E]=(0,e.useState)(""),F=async a=>{if(a.preventDefault(),v&&!z){A(!0),E("");try{let a=await s();if(!a){console.log(`模拟发送验证码到: ${v}`),u("code"),C(60);let a=setInterval(()=>{C(b=>b<=1?(clearInterval(a),0):b-1)},1e3);return}let b=await a("send_verification_code",{email:v});if(b.success){u("code"),C(60);let a=setInterval(()=>{C(b=>b<=1?(clearInterval(a),0):b-1)},1e3)}else E(b.message)}catch(a){console.error("发送验证码失败:",a),E("发送验证码失败，请稍后重试")}finally{A(!1)}}},G=async d=>{if(d.preventDefault(),v&&x&&!z){A(!0),E("");try{let d=await s();if(!d){if("123456"===x){let d={id:"mock-user-id",email:v,name:v.split("@")[0],avatar:void 0};localStorage.setItem("auth_user",JSON.stringify(d)),localStorage.setItem("auth_token","mock-token"),localStorage.setItem("auth_expires",(Date.now()+2592e6).toString()),a?.(d),b?.(d),c?.(d)}else E("验证码错误，请输入 123456");return}let e=await d("verify_code_and_login",{email:v,code:x});e.success&&e.user&&e.token?(await d("save_auth_data",{user:e.user,token:e.token,expiresAt:Date.now()+2592e6}),a?.(e.user),b?.(e.user),c?.(e.user)):E(e.message||"验证失败")}catch(a){console.error("验证码验证失败:",a),E("验证失败，请检查验证码是否正确")}finally{A(!1)}}};return"email"===t?(0,d.jsxs)(f.B,{gap:"md",children:[D&&(0,d.jsx)(g.F,{icon:(0,d.jsx)(o.A,{size:16}),color:"red",variant:"light",radius:"md",children:D}),(0,d.jsx)("form",{onSubmit:F,children:(0,d.jsxs)(f.B,{gap:"md",children:[(0,d.jsx)(h.k,{label:"邮箱地址",placeholder:"请输入您的邮箱地址",value:v,onChange:a=>w(a.currentTarget.value),leftSection:(0,d.jsx)(p.A,{size:16}),required:!0,disabled:z,radius:"md",size:"md",autoFocus:!0}),(0,d.jsx)(i.$,{type:"submit",size:"md",radius:"md",disabled:!v.trim()||z,loading:z,className:"flat-button",children:"发送验证码"})]})}),(0,d.jsx)(j.E,{size:"xs",c:"dimmed",ta:"center",children:"我们将向您的邮箱发送6位数字验证码"})]}):(0,d.jsxs)(f.B,{gap:"md",children:[D&&(0,d.jsx)(g.F,{icon:(0,d.jsx)(o.A,{size:16}),color:"red",variant:"light",radius:"md",children:D}),(0,d.jsxs)(k.t,{p:"md",bg:"blue.0",radius:"md",children:[(0,d.jsx)(j.E,{size:"sm",c:"blue",ta:"center",children:"验证码已发送至"}),(0,d.jsx)(j.E,{fw:600,ta:"center",mt:"xs",children:v})]}),(0,d.jsx)("form",{onSubmit:G,children:(0,d.jsxs)(f.B,{gap:"md",children:[(0,d.jsxs)(f.B,{gap:"xs",align:"center",children:[(0,d.jsx)(j.E,{size:"sm",fw:500,children:"请输入6位验证码"}),(0,d.jsx)(l.c,{value:x,onChange:y,length:6,size:"lg",radius:"md",disabled:z,autoFocus:!0})]}),(0,d.jsx)(i.$,{type:"submit",size:"md",radius:"md",disabled:6!==x.length||z,loading:z,className:"flat-button",children:"验证并登录"})]})}),(0,d.jsx)(m.c,{}),(0,d.jsxs)(n.Y,{justify:"space-between",children:[(0,d.jsx)(i.$,{variant:"subtle",leftSection:(0,d.jsx)(q.A,{size:16}),onClick:()=>{u("email"),y(""),E("")},disabled:z,size:"sm",children:"修改邮箱"}),(0,d.jsx)(i.$,{variant:"subtle",leftSection:(0,d.jsx)(r.A,{size:16}),onClick:()=>{B>0||F(new Event("submit"))},disabled:B>0||z,size:"sm",children:B>0?`${B}s 后重发`:"重新发送"})]}),!1,(0,d.jsx)(j.E,{size:"xs",c:"dimmed",ta:"center",children:"登录即表示您同意我们的服务条款和隐私政策"})]})}},44002:()=>{},44968:(a,b,c)=>{"use strict";function d(){return!1}function e(){return{isTauri:!1,isDev:!1,isBuild:!0,userAgent:"server",platform:"server"}}async function f(){return!1}async function g(){try{if(await f()){let{invoke:a}=await c.e(870).then(c.bind(c,23870)),{getCurrentWindow:b}=await c.e(297).then(c.bind(c,63297)),d=b();return{invoke:a,currentWindow:d}}}catch(a){console.warn("Failed to import Tauri API:",a)}return{invoke:null,currentWindow:null}}function h(){let a=e();console.log("\uD83D\uDD0D Environment Info:",a),a.isTauri?console.log("✅ Running in Tauri desktop app"):console.log("\uD83C\uDF10 Running in web browser")}c.d(b,{XI:()=>f,cR:()=>e,uL:()=>h,vo:()=>d,xU:()=>g})},45473:(a,b,c)=>{Promise.resolve().then(c.bind(c,54751))},47427:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,63638,23)),Promise.resolve().then(c.t.bind(c,82849,23)),Promise.resolve().then(c.t.bind(c,70361,23)),Promise.resolve().then(c.t.bind(c,86944,23)),Promise.resolve().then(c.t.bind(c,98496,23)),Promise.resolve().then(c.t.bind(c,98580,23)),Promise.resolve().then(c.t.bind(c,19426,23)),Promise.resolve().then(c.t.bind(c,75492,23)),Promise.resolve().then(c.t.bind(c,48612,23))},51605:(a,b,c)=>{"use strict";c.d(b,{c:()=>f});var d=c(91778),e=c(36341);let f=()=>{let a=(0,d.useRouter)(),b=(0,e.useCallback)(b=>{setTimeout(()=>{a.push(b)},0)},[a]);return{navigateTo:b,replace:(0,e.useCallback)(b=>{setTimeout(()=>{a.replace(b)},0)},[a]),back:(0,e.useCallback)(()=>{setTimeout(()=>{a.back()},0)},[a])}}},54751:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>y});var d=c(4460),e=c(71923),f=c(76538),g=c(74464),h=c(91778);c(44002);var i=c(36341),j=c(91445),k=c(37968),l=c(1094),m=c(41055),n=c(36332),o=c(89086),p=c(10492),q=c(70689),r=c(58740),s=c(63597),t=c(82094),u=c(51605);let v=({children:a,fallback:b})=>{let{isAuthenticated:c,isLoading:e,login:f}=(0,j.A)(),{navigateTo:g}=(0,u.c)(),[h,v]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{e||c||b||v(!0)},[e,c,b,g]),e)?(0,d.jsx)(l.o,{h:"100vh",bg:"gray.0",children:(0,d.jsx)(m.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,d.jsxs)(n.B,{align:"center",gap:"md",children:[(0,d.jsx)(o.a,{size:"lg"}),(0,d.jsx)(p.E,{c:"dimmed",children:"检查登录状态..."})]})})}):c?(0,d.jsx)(d.Fragment,{children:a}):b?(0,d.jsx)(d.Fragment,{children:b}):h?(0,d.jsx)(l.o,{h:"100vh",bg:"gray.0",p:"md",children:(0,d.jsx)(q.a,{maw:400,w:"100%",children:(0,d.jsxs)(n.B,{align:"center",gap:"xl",children:[(0,d.jsxs)(n.B,{align:"center",gap:"md",children:[(0,d.jsx)(s.A,{size:64,color:"#228be6"}),(0,d.jsx)(r.h,{order:2,ta:"center",children:"AI Desktop"}),(0,d.jsx)(p.E,{c:"dimmed",ta:"center",children:"使用邮箱验证码快速登录或注册"})]}),(0,d.jsx)(m.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,w:"100%",children:(0,d.jsx)(k.Q,{onLoginSuccess:a=>{f(a),v(!1),g("/")},onLogin:f})})]})})}):(0,d.jsx)(l.o,{h:"100vh",bg:"gray.0",children:(0,d.jsx)(m.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,d.jsxs)(n.B,{align:"center",gap:"md",children:[(0,d.jsx)(t.A,{size:48,color:"var(--mantine-color-gray-5)"}),(0,d.jsx)(p.E,{c:"dimmed",children:"需要登录才能访问"})]})})})},w=(0,e.a)({primaryColor:"blue",fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif",headings:{fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif",fontWeight:"600"},radius:{xs:"4px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadows:{xs:"0 1px 3px rgba(0, 0, 0, 0.05)",sm:"0 1px 3px rgba(0, 0, 0, 0.1)",md:"0 4px 12px rgba(0, 0, 0, 0.1)",lg:"0 8px 24px rgba(0, 0, 0, 0.12)",xl:"0 12px 32px rgba(0, 0, 0, 0.15)"},colors:{gray:["#fafafa","#f4f4f5","#e4e4e7","#d4d4d8","#a1a1aa","#71717a","#52525b","#3f3f46","#27272a","#18181b"]}});function x({children:a}){return"/login"===(0,h.usePathname)()?(0,d.jsx)(d.Fragment,{children:a}):(0,d.jsx)(v,{children:a})}function y({children:a}){return(0,d.jsx)("html",{lang:"zh-CN",children:(0,d.jsx)("body",{children:(0,d.jsxs)(f.y,{theme:w,children:[(0,d.jsx)(g.$,{position:"top-right"}),(0,d.jsx)(x,{children:a})]})})})}},61499:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,32760,23)),Promise.resolve().then(c.t.bind(c,84523,23)),Promise.resolve().then(c.t.bind(c,3191,23)),Promise.resolve().then(c.t.bind(c,14842,23)),Promise.resolve().then(c.t.bind(c,78334,23)),Promise.resolve().then(c.t.bind(c,51266,23)),Promise.resolve().then(c.t.bind(c,97424,23)),Promise.resolve().then(c.t.bind(c,79338,23)),Promise.resolve().then(c.bind(c,97098))},63269:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(21406).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/cavatina/projects/aicooper/apps/desktop/src/app/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/cavatina/projects/aicooper/apps/desktop/src/app/layout.tsx","default")},91445:(a,b,c)=>{"use strict";c.d(b,{A:()=>f});var d=c(36341),e=c(44968);let f=()=>{let[a,b]=(0,d.useState)(null),[c,f]=(0,d.useState)(!0),[g,h]=(0,d.useState)(!1),[i,j]=(0,d.useState)(!1);(0,d.useEffect)(()=>{(0,e.uL)(),k()},[]);let k=async()=>{let a=await (0,e.XI)();j(a),console.log(`🔍 Tauri环境检测结果: ${a?"✅ 是":"❌ 否"}`),await l()},l=async()=>{f(!0);try{let{invoke:a}=await (0,e.xU)();if(!i||!a){console.log("\uD83C\uDF10 Web环境：检查localStorage认证状态");let a=localStorage.getItem("auth_user"),c=localStorage.getItem("auth_token"),d=localStorage.getItem("auth_expires");if(a&&c&&d){let c=parseInt(d);if(Date.now()<c){let c=JSON.parse(a);b(c),h(!0),console.log("✅ Web环境：找到有效的认证数据")}else localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_expires"),console.log("⏰ Web环境：认证数据已过期，已清除")}else console.log("❌ Web环境：未找到认证数据");return}console.log("\uD83D\uDDA5️ Tauri环境：检查本地认证状态");let c=await a("get_auth_data");c?(b(c.user),h(!0),console.log("✅ Tauri环境：找到有效的认证数据")):console.log("❌ Tauri环境：未找到认证数据")}catch(a){console.error("❌ 检查认证状态失败:",a)}finally{f(!1)}},m=async()=>{try{let{invoke:a}=await (0,e.xU)();i&&a?(console.log("\uD83D\uDDA5️ Tauri环境：调用logout命令"),await a("logout")):(console.log("\uD83C\uDF10 Web环境：清除认证数据"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_expires"))}catch(a){console.error("❌ 登出失败:",a)}finally{b(null),h(!1),console.log("✅ 登出成功")}};return{user:a,isLoading:c,isAuthenticated:g,isTauriEnv:i,login:a=>{b(a),h(!0)},logout:m,checkAuthStatus:l}}}};