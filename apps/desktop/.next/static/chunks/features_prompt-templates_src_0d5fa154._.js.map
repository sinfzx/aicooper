{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/cavatina/projects/aicooper/features/prompt-templates/src/components/PromptTemplateManager.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react'\nimport {\n  Stack,\n  Group,\n  Title,\n  Text,\n  Button,\n  Card,\n  Badge,\n  ActionIcon,\n  TextInput,\n  Grid,\n  Center,\n  Box,\n  Paper,\n  Divider,\n  Modal,\n  Tabs\n} from '@mantine/core';\nimport {\n  IconTemplate,\n  IconSearch,\n  IconCopy,\n  IconEye,\n  IconEdit,\n  IconPlus,\n  IconRobot\n} from '@tabler/icons-react';\nimport { notifications } from '@mantine/notifications';\n// 暂时注释掉PageLayout导入，直接使用Stack布局\n// import { PageLayout } from '../../../apps/desktop/src/components/layout/PageLayout';\n\ntype TemplateItem = {\n  id: string;\n  title: string;\n  description: string;\n  category: string;\n  content: string; // API 字段名为 content\n}\n\nexport const PromptTemplateManager: React.FC = () => {\n  const [selectedCategory, setSelectedCategory] = useState<string>('全部')\n  const [searchTerm, setSearchTerm] = useState<string>('')\n  const [selectedTemplate, setSelectedTemplate] = useState<TemplateItem | null>(null)\n  const [viewModalOpen, setViewModalOpen] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [templates, setTemplates] = useState<TemplateItem[]>([])\n  // 原弹窗创建入口已移除，改为二级页面\n\n  const categories = ['全部', 'general', 'writing', 'coding', 'analysis', 'translation', 'education']\n\n  useEffect(() => {\n    const API_BASE = (process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3001').replace(/\\/$/, '')\n    const controller = new AbortController()\n    const load = async () => {\n      setLoading(true)\n      setError(null)\n      try {\n        const params = new URLSearchParams()\n        // 未登录默认拉取公开\n        params.set('public', 'true')\n        params.set('page', '1')\n        params.set('pageSize', '50')\n        const res = await fetch(`${API_BASE}/api/prompt-templates?${params.toString()}`, { signal: controller.signal })\n        const data = await res.json()\n        if (data?.success && Array.isArray(data?.data?.items)) {\n          setTemplates(data.data.items)\n        } else if (Array.isArray(data)) {\n          setTemplates(data as TemplateItem[])\n        } else {\n          throw new Error(data?.error || 'Invalid data format')\n        }\n      } catch (e: any) {\n        setError(e?.message || 'Failed to load templates')\n        setTemplates([])\n      } finally {\n        setLoading(false)\n      }\n    }\n    load()\n    return () => controller.abort()\n  }, [])\n\n  const filteredTemplates = useMemo(() => {\n    const list = Array.isArray(templates) ? templates : []\n    return list.filter((template) => {\n      const matchesCategory = selectedCategory === '全部' || template.category === selectedCategory\n      const searchLower = searchTerm.toLowerCase()\n      const matchesSearch = template.title.toLowerCase().includes(searchLower) || (template.description || '').toLowerCase().includes(searchLower)\n      return matchesCategory && matchesSearch\n    })\n  }, [templates, selectedCategory, searchTerm])\n\n  const handleCopyTemplate = (template: string) => {\n    navigator.clipboard.writeText(template)\n    notifications.show({\n      title: '复制成功',\n      message: '模板已复制到剪贴板',\n      color: 'green'\n    })\n  }\n\n  return (\n    <Stack gap=\"lg\" p=\"md\">\n      {/* 头部操作栏 */}\n      <Group justify=\"space-between\">\n        <Group>\n          <IconTemplate size={28} color=\"var(--mantine-color-green-6)\" />\n          <Box>\n            <Title order={2}>提示词模板库</Title>\n            <Text c=\"dimmed\" size=\"sm\">精选的 AI 提示词模板，提升您的工作效率</Text>\n          </Box>\n        </Group>\n        \n        <Group>\n          <Button\n            leftSection={<IconRobot size={16} />}\n            variant=\"gradient\"\n            gradient={{ from: 'green', to: 'teal' }}\n            onClick={() => {\n              if (typeof window !== 'undefined') {\n                window.location.href = '/templates/new?mode=ai'\n              }\n            }}\n          >\n            AI 生成\n          </Button>\n          <Button\n            leftSection={<IconPlus size={16} />}\n            onClick={() => {\n              if (typeof window !== 'undefined') {\n                window.location.href = '/templates/new'\n              }\n            }}\n          >\n            创建模板\n          </Button>\n        </Group>\n      </Group>\n\n      {/* 搜索和筛选 */}\n      <Group>\n        <TextInput\n          placeholder=\"搜索模板...\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.currentTarget.value)}\n          leftSection={<IconSearch size={16} />}\n          style={{ flex: 1 }}\n        />\n      </Group>\n\n      {/* 分类标签 */}\n      <Tabs value={selectedCategory} onChange={(value) => setSelectedCategory(value || '全部')}>\n        <Tabs.List>\n          {categories.map(category => (\n            <Tabs.Tab key={category} value={category}>\n              {category}\n            </Tabs.Tab>\n          ))}\n        </Tabs.List>\n      </Tabs>\n\n      {/* 模板列表 */}\n      {loading ? (\n        <Card shadow=\"sm\" padding=\"xl\" radius=\"md\" withBorder>\n          <Center>\n            <Text c=\"dimmed\">加载中...</Text>\n          </Center>\n        </Card>\n      ) : filteredTemplates.length === 0 ? (\n        <Card shadow=\"sm\" padding=\"xl\" radius=\"md\" withBorder>\n          <Center>\n            <Stack align=\"center\" gap=\"md\">\n              <IconTemplate size={64} color=\"var(--mantine-color-gray-5)\" />\n              <Title order={3} ta=\"center\">没有找到匹配的模板</Title>\n              <Text c=\"dimmed\" ta=\"center\" maw={400}>\n                {error ? `加载失败：${error}` : '尝试调整搜索条件或选择其他分类'}\n              </Text>\n            </Stack>\n          </Center>\n        </Card>\n      ) : (\n        <Grid>\n          {filteredTemplates.map(template => (\n            <Grid.Col key={template.id} span={{ base: 12, md: 6, lg: 4 }}>\n              <Card shadow=\"sm\" padding=\"lg\" radius=\"md\" withBorder h=\"100%\">\n                <Stack gap=\"sm\" h=\"100%\">\n                  <Group justify=\"space-between\">\n                    <Badge variant=\"light\" color=\"blue\" size=\"sm\">\n                      {template.category}\n                    </Badge>\n                  </Group>\n\n                  <Box style={{ flex: 1 }}>\n                    <Title order={4} mb=\"xs\">{template.title}</Title>\n                    <Text size=\"sm\" c=\"dimmed\" mb=\"sm\" lineClamp={2}>\n                      {template.description}\n                    </Text>\n                    \n                    <Paper p=\"sm\" bg=\"gray.0\" radius=\"md\" mb=\"sm\">\n                      <Text size=\"xs\" c=\"dimmed\" lineClamp={4} style={{ fontFamily: 'monospace' }}>\n                        {template.content}\n                      </Text>\n                    </Paper>\n                  </Box>\n\n                  <Divider />\n\n                  <Group justify=\"space-between\">\n                    <Group gap=\"xs\">\n                      <ActionIcon\n                        variant=\"light\"\n                        size=\"sm\"\n                        onClick={() => {\n                          // 导航到详情页面\n                          if (typeof window !== 'undefined') {\n                            window.location.href = `/templates/${template.id}`;\n                          }\n                        }}\n                      >\n                        <IconEye size={14} />\n                      </ActionIcon>\n                      <ActionIcon\n                        variant=\"light\"\n                        size=\"sm\"\n                        onClick={() => {\n                          // TODO: 编辑功能\n                        }}\n                      >\n                        <IconEdit size={14} />\n                      </ActionIcon>\n                    </Group>\n                    \n                    <Button\n                      size=\"xs\"\n                      leftSection={<IconCopy size={12} />}\n                      onClick={() => handleCopyTemplate(template.content)}\n                    >\n                      复制\n                    </Button>\n                  </Group>\n                </Stack>\n              </Card>\n            </Grid.Col>\n          ))}\n        </Grid>\n      )}\n\n      {/* 查看详情模态框 */}\n      <Modal\n        opened={viewModalOpen}\n        onClose={() => setViewModalOpen(false)}\n        title={selectedTemplate?.title || '模板详情'}\n        size=\"lg\"\n      >\n        {selectedTemplate && (\n          <Stack gap=\"md\">\n            <Group>\n              <Badge color=\"blue\">{selectedTemplate.category}</Badge>\n            </Group>\n            \n            <Text>{selectedTemplate.description}</Text>\n            \n            <Box>\n              <Text fw={500} mb=\"sm\">模板内容：</Text>\n              <Paper p=\"md\" withBorder bg=\"gray.0\">\n                <Text size=\"sm\" style={{ whiteSpace: 'pre-wrap', fontFamily: 'monospace' }}>\n                  {selectedTemplate.content}\n                </Text>\n              </Paper>\n            </Box>\n            \n            <Group justify=\"flex-end\">\n              <Button\n                leftSection={<IconCopy size={16} />}\n                onClick={() => {\n                  handleCopyTemplate(selectedTemplate.content)\n                  setViewModalOpen(false)\n                }}\n              >\n                复制模板\n              </Button>\n            </Group>\n          </Stack>\n        )}\n      </Modal>\n\n      {/* 创建模板改为二级页面 /templates/new */}\n    </Stack>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 664, "column": 0}, "map": {"version":3,"sources":["file:///Users/cavatina/projects/aicooper/features/prompt-templates/src/hooks/usePromptTemplate.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\n\n// 临时类型定义\ninterface PromptTemplate {\n  id: string;\n  title: string;\n  description: string;\n  category: string;\n  template: string;\n}\n\nexport const usePromptTemplate = () => {\n  const [templates, setTemplates] = useState<PromptTemplate[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadTemplates();\n  }, []);\n\n  const loadTemplates = async () => {\n    try {\n      setLoading(true);\n      // 这里应该调用实际的API\n      // const templates = await dbApi.getPromptTemplates();\n      // setTemplates(templates.data || []);\n      \n      // 临时使用空数组\n      setTemplates([]);\n    } catch (error) {\n      console.error('Failed to load templates:', error);\n      setError('加载模板失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createTemplate = async (templateData: any) => {\n    try {\n      // 这里应该调用实际的创建API\n      console.log('Creating template:', templateData);\n      await loadTemplates();\n    } catch (error) {\n      console.error('Failed to create template:', error);\n      throw error;\n    }\n  };\n\n  const updateTemplate = async (id: string, updates: Partial<PromptTemplate>) => {\n    try {\n      // 这里应该调用实际的更新API\n      console.log('Updating template:', id, updates);\n      await loadTemplates();\n    } catch (error) {\n      console.error('Failed to update template:', error);\n      throw error;\n    }\n  };\n\n  const deleteTemplate = async (id: string) => {\n    try {\n      // 这里应该调用实际的删除API\n      console.log('Deleting template:', id);\n      await loadTemplates();\n    } catch (error) {\n      console.error('Failed to delete template:', error);\n      throw error;\n    }\n  };\n\n  return {\n    templates,\n    loading,\n    error,\n    loadTemplates,\n    createTemplate,\n    updateTemplate,\n    deleteTemplate\n  };\n};"],"names":[],"mappings":";;;AAAA;;;AAWO,MAAM,oBAAoB;;IAC/B,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,8TAAA,CAAA,WAAQ,AAAD,EAAoB,EAAE;IAC/D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,8TAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,8TAAA,CAAA,WAAQ,AAAD,EAAiB;IAElD,CAAA,GAAA,8TAAA,CAAA,YAAS,AAAD;uCAAE;YACR;QACF;sCAAG,EAAE;IAEL,MAAM,gBAAgB;QACpB,IAAI;YACF,WAAW;YACX,eAAe;YACf,sDAAsD;YACtD,sCAAsC;YAEtC,UAAU;YACV,aAAa,EAAE;QACjB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,SAAS;QACX,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,iBAAiB;YACjB,QAAQ,GAAG,CAAC,sBAAsB;YAClC,MAAM;QACR,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,MAAM;QACR;IACF;IAEA,MAAM,iBAAiB,OAAO,IAAY;QACxC,IAAI;YACF,iBAAiB;YACjB,QAAQ,GAAG,CAAC,sBAAsB,IAAI;YACtC,MAAM;QACR,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,MAAM;QACR;IACF;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,iBAAiB;YACjB,QAAQ,GAAG,CAAC,sBAAsB;YAClC,MAAM;QACR,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,MAAM;QACR;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA;IACF;AACF;GApEa","debugId":null}},
    {"offset": {"line": 745, "column": 0}, "map": {"version":3,"sources":["file:///Users/cavatina/projects/aicooper/features/prompt-templates/src/components/PromptTemplateCreator.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from 'react';\nimport { Stack, Group, TextInput, Textarea, Select, Button, MultiSelect } from '@mantine/core';\nimport { IconCheck, IconX } from '@tabler/icons-react';\nimport { notifications } from '@mantine/notifications';\nimport { usePromptTemplate } from '../hooks/usePromptTemplate';\n\ninterface PromptTemplateCreatorProps {\n  mode?: 'ai' | 'manual';\n  onCancel?: () => void;\n  onCreated?: () => void;\n}\n\nexport const PromptTemplateCreator: React.FC<PromptTemplateCreatorProps> = ({ mode, onCancel, onCreated }) => {\n  const { createTemplate } = usePromptTemplate();\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [category, setCategory] = useState('');\n  const [content, setContent] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [tagIds, setTagIds] = useState<string[]>([]);\n  const [availableTags, setAvailableTags] = useState<{ value: string; label: string }[]>([]);\n\n  React.useEffect(() => {\n    (async () => {\n      try {\n        const API_BASE = (process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:3001').replace(/\\/$/, '');\n        const res = await fetch(`${API_BASE}/api/tags`);\n        const data = await res.json();\n        if (data.success) {\n          setAvailableTags(\n            data.data.map((t: any) => ({ value: t.id, label: t.parent ? `${t.parent.name} / ${t.name}` : t.name }))\n          );\n        }\n      } catch {}\n    })();\n  }, []);\n\n  const handleSubmit = async () => {\n    try {\n      setSubmitting(true);\n      await createTemplate({ title, description, category, content, mode, tags: tagIds });\n      notifications.show({ title: '创建成功', message: '模板已创建', color: 'green', icon: <IconCheck size={16} /> });\n      onCreated?.();\n    } catch (error) {\n      notifications.show({ title: '创建失败', message: '无法创建模板', color: 'red', icon: <IconX size={16} /> });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <Stack gap=\"md\">\n      <TextInput label=\"标题\" placeholder=\"模板标题\" value={title} onChange={(e) => setTitle(e.currentTarget.value)} required />\n      <Textarea label=\"描述\" placeholder=\"简要描述模板用途\" value={description} onChange={(e) => setDescription(e.currentTarget.value)} minRows={2} required />\n      <Select label=\"分类\" placeholder=\"选择分类\" value={category} onChange={(v) => setCategory(v || '')} data={[ '写作', '编程', '分析', '翻译', '教育', '营销', '其他' ]} required />\n      <Textarea label=\"模板内容\" placeholder=\"输入模板内容，使用 {参数名} 表示可替换参数\" value={content} onChange={(e) => setContent(e.currentTarget.value)} minRows={8} required />\n      <MultiSelect label=\"标签\" placeholder=\"选择标签\" data={availableTags} value={tagIds} onChange={setTagIds} searchable clearable />\n      <Group justify=\"flex-end\">\n        {onCancel && <Button variant=\"light\" onClick={onCancel}>取消</Button>}\n        <Button onClick={handleSubmit} loading={submitting} disabled={!title || !description || !category || !content}>\n          保存\n        </Button>\n      </Group>\n    </Stack>\n  );\n};\n\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 966, "column": 0}, "map": {"version":3,"sources":["file:///Users/cavatina/projects/aicooper/features/prompt-templates/src/index.ts"],"sourcesContent":["// Prompt Templates Feature\nexport { PromptTemplateManager } from './components/PromptTemplateManager';\nexport { PromptTemplateCreator } from './components/PromptTemplateCreator';\nexport { usePromptTemplate } from './hooks/usePromptTemplate';\n\n// Types\nexport type { PromptTemplate, PromptParameter } from '@my-platform/types';\n"],"names":[],"mappings":"AAAA,2BAA2B;;AAC3B;AACA;AACA","debugId":null}}]
}