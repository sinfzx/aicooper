(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{1742:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>F});var l=r(7770),i=r(6354),t=r(8582),s=r(9764),d=r(3433),n=r(2971),o=r(8732),c=r(8024),h=r(202),m=r(2993),p=r(7710),g=r(7775),x=r(9822),u=r(3810),j=r(2055),w=r(2812),v=r(6907),b=r(5864),A=r(9547),f=r(1874),k=r(435),y=r(7998),C=r(2199),_=r(7292),E=r(4842),I=r(4171),z=r(7597),B=r(8780),K=r(7379);let S={dbCreateApiKey:e=>(0,K.invoke)("db_create_api_key",{request:e}),dbGetApiKeys:()=>(0,K.invoke)("db_get_api_keys"),dbCallAi:e=>(0,K.invoke)("db_call_ai",{request:e}),dbGetKnowledgeFrameworks:()=>(0,K.invoke)("db_get_knowledge_frameworks"),dbCreateKnowledgeFrameworkWithAi:(e,a,r)=>(0,K.invoke)("db_create_knowledge_framework_with_ai",{title:e,description:a,domain:r}),dbGetFlowDesigns:()=>(0,K.invoke)("db_get_flow_designs"),dbCreateFlowDesignWithAi:(e,a,r,l)=>(0,K.invoke)("db_create_flow_design_with_ai",{title:e,description:a,goals:r,difficulty:l}),dbGetPromptTemplates:()=>(0,K.invoke)("db_get_prompt_templates"),dbCreatePromptTemplateWithAi:(e,a,r,l,i)=>(0,K.invoke)("db_create_prompt_template_with_ai",{title:e,description:a,category:r,purpose:l,targetUser:i})},P=async e=>{try{let a=await e();return{success:!0,data:a}}catch(e){return console.error("Tauri invoke error:",e),{success:!1,error:e}}},T={createApiKey:function(e,a,r,l,i){let t=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return P(()=>S.dbCreateApiKey({name:e,provider:a,apiKey:r,baseUrl:l,model:i,isDefault:t}))},getApiKeys:()=>P(()=>S.dbGetApiKeys()),callAi:(e,a,r,l,i)=>P(()=>S.dbCallAi({prompt:e,systemPrompt:a,model:r,maxTokens:l,temperature:i})),getKnowledgeFrameworks:()=>P(()=>S.dbGetKnowledgeFrameworks()),createKnowledgeFrameworkWithAi:(e,a,r)=>P(()=>S.dbCreateKnowledgeFrameworkWithAi(e,a,r)),getFlowDesigns:()=>P(()=>S.dbGetFlowDesigns()),createFlowDesignWithAi:(e,a,r,l)=>P(()=>S.dbCreateFlowDesignWithAi(e,a,r,l)),getPromptTemplates:()=>P(()=>S.dbGetPromptTemplates()),createPromptTemplateWithAi:(e,a,r,l,i)=>P(()=>S.dbCreatePromptTemplateWithAi(e,a,r,l,i))};function F(){let[e,a]=(0,i.useState)(!1),[r,K]=(0,i.useState)([]),[S,P]=(0,i.useState)([]),[F,$]=(0,i.useState)([]),[D,q]=(0,i.useState)([]),[W,Y]=(0,i.useState)({name:"",provider:"openai",apiKey:"",baseUrl:"",model:"",isDefault:!1}),[U,Z]=(0,i.useState)({prompt:"你好，请介绍一下你自己",systemPrompt:"你是一个友好的AI助手",model:"",maxTokens:1e3,temperature:.7}),[G,R]=(0,i.useState)({title:"",description:"",domain:""}),[L,O]=(0,i.useState)({title:"",description:"",goals:"",difficulty:"medium"}),[N,M]=(0,i.useState)({title:"",description:"",category:"",purpose:"",targetUser:""}),[V,H]=(0,i.useState)(null),[J,Q]=(0,i.useState)(!1),[X,ee]=(0,i.useState)("apikey");(0,i.useEffect)(()=>{ea()},[]);let ea=async()=>{a(!0);try{let[e,a,r,l]=await Promise.all([T.getApiKeys(),T.getKnowledgeFrameworks(),T.getFlowDesigns(),T.getPromptTemplates()]);e.success&&K(e.data||[]),a.success&&P(a.data||[]),r.success&&$(r.data||[]),l.success&&q(l.data||[])}catch(e){console.error("Failed to load data:",e),B.$e.show({title:"加载失败",message:"无法加载数据",color:"red"})}finally{a(!1)}},er=async()=>{if(!W.name||!W.provider||!W.apiKey)return void B.$e.show({title:"表单错误",message:"请填写必填字段",color:"red"});let e=await T.createApiKey(W.name,W.provider,W.apiKey,W.baseUrl||void 0,W.model||void 0,W.isDefault);e.success?(B.$e.show({title:"创建成功",message:"API Key 已创建",color:"green"}),Y({name:"",provider:"openai",apiKey:"",baseUrl:"",model:"",isDefault:!1}),Q(!1),ea()):B.$e.show({title:"创建失败",message:e.error||"未知错误",color:"red"})},el=async()=>{if(!U.prompt)return void B.$e.show({title:"表单错误",message:"请输入提示词",color:"red"});a(!0);let e=await T.callAi(U.prompt,U.systemPrompt||void 0,U.model||void 0,U.maxTokens,U.temperature);e.success?(H(e.data),B.$e.show({title:"AI 调用成功",message:"已获得AI响应",color:"green"})):B.$e.show({title:"AI 调用失败",message:e.error||"未知错误",color:"red"}),a(!1)},ei=async e=>{let r;a(!0);try{switch(e){case"framework":if(!G.title||!G.description||!G.domain)throw Error("请填写所有必填字段");r=await T.createKnowledgeFrameworkWithAi(G.title,G.description,G.domain);break;case"flow":if(!L.title||!L.description||!L.goals)throw Error("请填写所有必填字段");r=await T.createFlowDesignWithAi(L.title,L.description,L.goals,L.difficulty);break;case"template":if(!N.title||!N.description||!N.category)throw Error("请填写所有必填字段");r=await T.createPromptTemplateWithAi(N.title,N.description,N.category,N.purpose,N.targetUser)}if(null==r?void 0:r.success)B.$e.show({title:"AI 创建成功",message:"".concat("framework"===e?"知识框架":"flow"===e?"流程设计":"提示模板","已创建"),color:"green"}),Q(!1),ea();else throw Error((null==r?void 0:r.error)||"创建失败")}catch(e){B.$e.show({title:"AI 创建失败",message:e instanceof Error?e.message:"未知错误",color:"red"})}finally{a(!1)}};return(0,l.jsxs)(t.B,{gap:"lg",p:"md",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsxs)(c.Y,{children:[(0,l.jsx)(A.A,{size:32,color:"var(--mantine-color-blue-6)"}),(0,l.jsxs)(h.a,{children:[(0,l.jsx)(m.h,{order:2,children:"Tauri AI 服务测试"}),(0,l.jsx)(p.E,{c:"dimmed",size:"sm",children:"测试本地数据库和AI服务功能"})]})]}),(0,l.jsxs)(c.Y,{children:[(0,l.jsx)(g.M,{variant:"light",onClick:ea,loading:e,children:(0,l.jsx)(f.A,{size:16})}),(0,l.jsx)(n.$,{leftSection:(0,l.jsx)(k.A,{size:16}),onClick:()=>Q(!0),children:"创建"})]})]}),(0,l.jsxs)(x.t,{defaultValue:"ai-test",children:[(0,l.jsxs)(x.t.List,{children:[(0,l.jsx)(x.t.Tab,{value:"ai-test",leftSection:(0,l.jsx)(A.A,{size:16}),children:"AI 测试"}),(0,l.jsxs)(x.t.Tab,{value:"api-keys",leftSection:(0,l.jsx)(y.A,{size:16}),children:["API Keys (",r.length,")"]}),(0,l.jsxs)(x.t.Tab,{value:"frameworks",leftSection:(0,l.jsx)(C.A,{size:16}),children:["知识框架 (",S.length,")"]}),(0,l.jsxs)(x.t.Tab,{value:"flows",leftSection:(0,l.jsx)(_.A,{size:16}),children:["流程设计 (",F.length,")"]}),(0,l.jsxs)(x.t.Tab,{value:"templates",leftSection:(0,l.jsx)(E.A,{size:16}),children:["提示模板 (",D.length,")"]})]}),(0,l.jsx)(x.t.Panel,{value:"ai-test",pt:"md",children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsx)(m.h,{order:4,children:"AI 服务测试"}),(0,l.jsx)(o.T,{label:"提示词",placeholder:"输入你的问题...",value:U.prompt,onChange:e=>Z({...U,prompt:e.target.value}),minRows:3}),(0,l.jsx)(o.T,{label:"系统提示词 (可选)",placeholder:"你是一个...",value:U.systemPrompt,onChange:e=>Z({...U,systemPrompt:e.target.value}),minRows:2}),(0,l.jsxs)(c.Y,{children:[(0,l.jsx)(s.k,{label:"模型 (可选)",placeholder:"gpt-3.5-turbo",value:U.model,onChange:e=>Z({...U,model:e.target.value}),style:{flex:1}}),(0,l.jsx)(s.k,{label:"最大Token",type:"number",value:U.maxTokens,onChange:e=>Z({...U,maxTokens:parseInt(e.target.value)||1e3}),style:{width:120}}),(0,l.jsx)(s.k,{label:"温度",type:"number",step:"0.1",min:"0",max:"2",value:U.temperature,onChange:e=>Z({...U,temperature:parseFloat(e.target.value)||.7}),style:{width:100}})]}),(0,l.jsx)(n.$,{leftSection:(0,l.jsx)(I.A,{size:16}),onClick:el,loading:e,children:"测试 AI"})]})}),V&&(0,l.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsx)(m.h,{order:4,children:"AI 响应"}),(0,l.jsxs)(c.Y,{gap:"xs",children:[V.provider&&(0,l.jsx)(j.E,{variant:"light",color:"blue",children:V.provider}),V.model&&(0,l.jsx)(j.E,{variant:"outline",children:V.model}),V.tokens&&(0,l.jsxs)(j.E,{variant:"light",color:"green",children:[V.tokens," tokens"]})]})]}),V.success?(0,l.jsxs)(h.a,{children:[(0,l.jsx)(p.E,{size:"sm",c:"dimmed",mb:"xs",children:"响应内容："}),(0,l.jsx)(w.C,{block:!0,children:V.data})]}):(0,l.jsx)(v.F,{color:"red",title:"错误",children:V.error})]})})]})}),(0,l.jsx)(x.t.Panel,{value:"api-keys",pt:"md",children:(0,l.jsx)(t.B,{gap:"md",children:0===r.length?(0,l.jsx)(u.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{align:"center",gap:"md",children:[(0,l.jsx)(y.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(m.h,{order:4,ta:"center",children:"还没有 API Keys"}),(0,l.jsx)(p.E,{c:"dimmed",ta:"center",children:"添加你的第一个 API Key 来开始使用 AI 服务"}),(0,l.jsx)(n.$,{leftSection:(0,l.jsx)(k.A,{size:16}),onClick:()=>{ee("apikey"),Q(!0)},children:"添加 API Key"})]})}):r.map(e=>(0,l.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsxs)(t.B,{gap:"xs",children:[(0,l.jsxs)(c.Y,{gap:"xs",children:[(0,l.jsx)(p.E,{fw:500,children:e.name}),(0,l.jsx)(j.E,{variant:"light",color:"openai"===e.provider?"green":"blue",children:e.provider}),e.is_default&&(0,l.jsx)(j.E,{variant:"filled",color:"orange",size:"sm",children:"默认"}),e.is_active?(0,l.jsx)(j.E,{variant:"light",color:"green",size:"sm",children:"活跃"}):(0,l.jsx)(j.E,{variant:"light",color:"gray",size:"sm",children:"禁用"})]}),(0,l.jsxs)(p.E,{size:"sm",c:"dimmed",children:[e.model&&"模型: ".concat(e.model," • "),"创建于: ",new Date(e.created_at).toLocaleString()]})]}),(0,l.jsx)(g.M,{variant:"light",color:"red",size:"sm",children:(0,l.jsx)(z.A,{size:14})})]})},e.id))})}),(0,l.jsx)(x.t.Panel,{value:"frameworks",pt:"md",children:(0,l.jsx)(t.B,{gap:"md",children:0===S.length?(0,l.jsx)(u.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{align:"center",gap:"md",children:[(0,l.jsx)(C.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(m.h,{order:4,ta:"center",children:"还没有知识框架"}),(0,l.jsx)(p.E,{c:"dimmed",ta:"center",children:"使用 AI 创建你的第一个知识框架"}),(0,l.jsx)(n.$,{leftSection:(0,l.jsx)(A.A,{size:16}),onClick:()=>{ee("framework"),Q(!0)},children:"AI 创建框架"})]})}):S.map(e=>(0,l.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"xs",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsx)(p.E,{fw:500,children:e.title}),(0,l.jsx)(j.E,{variant:"light",children:e.domain})]}),(0,l.jsx)(p.E,{size:"sm",c:"dimmed",children:e.description}),(0,l.jsxs)(p.E,{size:"xs",c:"dimmed",children:["创建于: ",new Date(e.created_at).toLocaleString()]})]})},e.id))})}),(0,l.jsx)(x.t.Panel,{value:"flows",pt:"md",children:(0,l.jsx)(t.B,{gap:"md",children:0===F.length?(0,l.jsx)(u.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{align:"center",gap:"md",children:[(0,l.jsx)(_.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(m.h,{order:4,ta:"center",children:"还没有流程设计"}),(0,l.jsx)(p.E,{c:"dimmed",ta:"center",children:"使用 AI 创建你的第一个流程设计"}),(0,l.jsx)(n.$,{leftSection:(0,l.jsx)(A.A,{size:16}),onClick:()=>{ee("flow"),Q(!0)},children:"AI 创建流程"})]})}):F.map(e=>(0,l.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"xs",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsx)(p.E,{fw:500,children:e.title}),(0,l.jsx)(j.E,{variant:"light",color:"easy"===e.difficulty?"green":"medium"===e.difficulty?"yellow":"red",children:e.difficulty})]}),(0,l.jsx)(p.E,{size:"sm",c:"dimmed",children:e.description}),(0,l.jsxs)(p.E,{size:"xs",c:"dimmed",children:["创建于: ",new Date(e.created_at).toLocaleString()]})]})},e.id))})}),(0,l.jsx)(x.t.Panel,{value:"templates",pt:"md",children:(0,l.jsx)(t.B,{gap:"md",children:0===D.length?(0,l.jsx)(u.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{align:"center",gap:"md",children:[(0,l.jsx)(E.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(m.h,{order:4,ta:"center",children:"还没有提示模板"}),(0,l.jsx)(p.E,{c:"dimmed",ta:"center",children:"使用 AI 创建你的第一个提示模板"}),(0,l.jsx)(n.$,{leftSection:(0,l.jsx)(A.A,{size:16}),onClick:()=>{ee("template"),Q(!0)},children:"AI 创建模板"})]})}):D.map(e=>(0,l.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"xs",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsx)(p.E,{fw:500,children:e.title}),(0,l.jsx)(j.E,{variant:"light",children:e.category})]}),(0,l.jsx)(p.E,{size:"sm",c:"dimmed",children:e.description}),(0,l.jsxs)(c.Y,{gap:"xs",children:[(0,l.jsxs)(p.E,{size:"xs",c:"dimmed",children:["使用次数: ",e.usage_count]}),(0,l.jsxs)(p.E,{size:"xs",c:"dimmed",children:["评分: ",e.rating.toFixed(1)]})]}),(0,l.jsxs)(p.E,{size:"xs",c:"dimmed",children:["创建于: ",new Date(e.created_at).toLocaleString()]})]})},e.id))})})]}),(0,l.jsx)(b.a,{opened:J,onClose:()=>Q(!1),title:"apikey"===X?"创建 API Key":"framework"===X?"AI 创建知识框架":"flow"===X?"AI 创建流程设计":"AI 创建提示模板",size:"md",children:(()=>{switch(X){case"apikey":return(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsx)(s.k,{label:"名称",placeholder:"我的 OpenAI Key",value:W.name,onChange:e=>Y({...W,name:e.target.value}),required:!0}),(0,l.jsx)(d.l,{label:"提供商",value:W.provider,onChange:e=>Y({...W,provider:e||"openai"}),data:[{value:"openai",label:"OpenAI"},{value:"anthropic",label:"Anthropic"}],required:!0}),(0,l.jsx)(s.k,{label:"API Key",placeholder:"sk-...",value:W.apiKey,onChange:e=>Y({...W,apiKey:e.target.value}),required:!0}),(0,l.jsx)(s.k,{label:"Base URL (可选)",placeholder:"https://api.openai.com/v1",value:W.baseUrl,onChange:e=>Y({...W,baseUrl:e.target.value})}),(0,l.jsx)(s.k,{label:"默认模型 (可选)",placeholder:"gpt-3.5-turbo",value:W.model,onChange:e=>Y({...W,model:e.target.value})}),(0,l.jsx)(n.$,{onClick:er,loading:e,children:"创建 API Key"})]});case"framework":return(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsx)(s.k,{label:"标题",placeholder:"React 开发框架",value:G.title,onChange:e=>R({...G,title:e.target.value}),required:!0}),(0,l.jsx)(o.T,{label:"描述",placeholder:"一个完整的React开发学习框架",value:G.description,onChange:e=>R({...G,description:e.target.value}),required:!0}),(0,l.jsx)(s.k,{label:"领域",placeholder:"前端开发",value:G.domain,onChange:e=>R({...G,domain:e.target.value}),required:!0}),(0,l.jsx)(n.$,{onClick:()=>ei("framework"),loading:e,children:"AI 创建知识框架"})]});case"flow":return(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsx)(s.k,{label:"标题",placeholder:"部署React应用",value:L.title,onChange:e=>O({...L,title:e.target.value}),required:!0}),(0,l.jsx)(o.T,{label:"描述",placeholder:"详细的React应用部署流程",value:L.description,onChange:e=>O({...L,description:e.target.value}),required:!0}),(0,l.jsx)(o.T,{label:"目标",placeholder:"成功部署一个React应用到生产环境",value:L.goals,onChange:e=>O({...L,goals:e.target.value}),required:!0}),(0,l.jsx)(d.l,{label:"难度",value:L.difficulty,onChange:e=>O({...L,difficulty:e||"medium"}),data:[{value:"easy",label:"简单"},{value:"medium",label:"中等"},{value:"hard",label:"困难"}]}),(0,l.jsx)(n.$,{onClick:()=>ei("flow"),loading:e,children:"AI 创建流程设计"})]});case"template":return(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsx)(s.k,{label:"标题",placeholder:"代码审查助手",value:N.title,onChange:e=>M({...N,title:e.target.value}),required:!0}),(0,l.jsx)(o.T,{label:"描述",placeholder:"帮助进行代码审查的AI助手",value:N.description,onChange:e=>M({...N,description:e.target.value}),required:!0}),(0,l.jsx)(s.k,{label:"分类",placeholder:"开发工具",value:N.category,onChange:e=>M({...N,category:e.target.value}),required:!0}),(0,l.jsx)(o.T,{label:"用途",placeholder:"审查代码质量，提供改进建议",value:N.purpose,onChange:e=>M({...N,purpose:e.target.value})}),(0,l.jsx)(s.k,{label:"目标用户",placeholder:"软件开发者",value:N.targetUser,onChange:e=>M({...N,targetUser:e.target.value})}),(0,l.jsx)(n.$,{onClick:()=>ei("template"),loading:e,children:"AI 创建提示模板"})]})}})()})]})}},9784:(e,a,r)=>{Promise.resolve().then(r.bind(r,1742))}},e=>{e.O(0,[315,155,57,167,387,364,540,251,854,162,358],()=>e(e.s=9784)),_N_E=e.O()}]);