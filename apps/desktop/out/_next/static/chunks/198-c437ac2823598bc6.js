"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[198],{2689:(e,i,s)=>{s.d(i,{mq:()=>E});var l=s(7770),r=s(6354);new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();let n=e=>{let{node:i,onToggleExpand:s,onGenerateChildren:l,onSearch:r,searchProviders:t}=e,[a,d]=useState(!1);return _jsxs(Box,{mb:"md",children:[_jsxs(Card,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,children:[_jsxs(Group,{justify:"space-between",mb:"xs",children:[_jsxs(Group,{gap:"sm",children:[_jsx(ActionIcon,{variant:"subtle",onClick:()=>s(i.id),size:"sm",children:i.children.length>0?i.expanded?_jsx(IconFolderOpen,{size:18}):_jsx(IconFolder,{size:18}):_jsx(IconFile,{size:18})}),_jsx(Title,{order:4,size:"md",children:i.title})]}),_jsxs(Group,{gap:"xs",children:[_jsx(ActionIcon,{variant:"subtle",onClick:()=>d(!a),size:"sm",children:a?_jsx(IconEyeOff,{size:16}):_jsx(IconEye,{size:16})}),_jsx(Button,{variant:"light",size:"xs",leftSection:_jsx(IconRobot,{size:14}),onClick:()=>l(i),children:"AI扩展"})]})]}),i.description&&_jsx(Text,{size:"sm",c:"dimmed",mb:"sm",children:i.description}),_jsx(Collapse,{in:a&&i.questions.length>0,children:_jsxs(Paper,{p:"sm",bg:"gray.0",radius:"sm",mt:"sm",children:[_jsx(Text,{size:"sm",fw:500,mb:"xs",children:"相关问题："}),_jsx(Stack,{gap:"xs",children:i.questions.map((e,s)=>_jsxs(Group,{justify:"space-between",align:"flex-start",children:[_jsxs(Text,{size:"sm",style:{flex:1},children:["• ",e]}),_jsx(Group,{gap:"xs",children:t.filter(e=>e.enabled).map(s=>_jsx(ActionIcon,{size:"xs",variant:"light",onClick:()=>r("".concat(e," ").concat(i.title)),title:"在".concat(s.name,"中搜索"),children:_jsx(IconSearch,{size:12})},s.id))})]},s))})]})})]}),_jsx(Collapse,{in:i.expanded&&i.children.length>0,children:_jsx(Box,{ml:"xl",pl:"md",style:{borderLeft:"2px solid var(--mantine-color-gray-3)"},children:_jsx(Stack,{gap:"sm",mt:"sm",children:i.children.map(e=>_jsx(n,{node:e,onToggleExpand:s,onGenerateChildren:l,onSearch:r,searchProviders:t},e.id))})})})]})};var t=s(1421),a=s(8582),d=s(7710),c=s(8024),o=s(202),h=s(2993),x=s(2971),m=s(3810),j=s(7935),u=s(2055),p=s(2109),g=s(7775),y=s(5864),w=s(9764),v=s(8732),f=s(6454),b=s(2199),A=s(9547),z=s(435),S=s(7044),I=s(591),k=s(7597),C=s(8780);let E=e=>{let{onFrameworkSelect:i}=e,[s,n]=(0,r.useState)([]),[E,_]=(0,r.useState)(!0),[T,Y]=(0,r.useState)(!1),[B,P]=(0,r.useState)(!1),[K,D]=(0,r.useState)(null),[$,q]=(0,r.useState)({title:"",description:"",domain:""}),[O,F]=(0,r.useState)({title:"",description:"",domain:"",targetUser:"",complexity:"medium"}),[R,U]=(0,r.useState)(!1);(0,r.useEffect)(()=>{L()},[]);let L=async()=>{try{_(!0),n([])}catch(e){console.error("Failed to load frameworks:",e),C.$e.show({title:"加载失败",message:"无法加载知识框架",color:"red"})}finally{_(!1)}},Z=async()=>{try{C.$e.show({title:"创建成功",message:"知识框架已创建",color:"green"}),Y(!1),M(),L()}catch(e){C.$e.show({title:"创建失败",message:"无法创建知识框架",color:"red"})}},G=async()=>{try{U(!0),C.$e.show({title:"AI 创建成功",message:"知识框架已通过 AI 辅助创建",color:"green"}),P(!1),F({title:"",description:"",domain:"",targetUser:"",complexity:"medium"}),L()}catch(e){C.$e.show({title:"AI 创建失败",message:"无法通过 AI 创建知识框架",color:"red"})}finally{U(!1)}},M=()=>{q({title:"",description:"",domain:""})};return E?(0,l.jsx)(t.o,{h:400,children:(0,l.jsxs)(a.B,{align:"center",children:[(0,l.jsx)(b.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(d.E,{c:"dimmed",children:"加载知识框架..."})]})}):(0,l.jsxs)(a.B,{gap:"lg",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsxs)(c.Y,{children:[(0,l.jsx)(b.A,{size:28,color:"var(--mantine-color-violet-6)"}),(0,l.jsxs)(o.a,{children:[(0,l.jsx)(h.h,{order:2,children:"知识框架"}),(0,l.jsx)(d.E,{c:"dimmed",size:"sm",children:"创建和管理结构化知识体系"})]})]}),(0,l.jsxs)(c.Y,{children:[(0,l.jsx)(x.$,{leftSection:(0,l.jsx)(A.A,{size:16}),variant:"gradient",gradient:{from:"violet",to:"purple"},onClick:()=>P(!0),children:"AI 创建"}),(0,l.jsx)(x.$,{leftSection:(0,l.jsx)(z.A,{size:16}),onClick:()=>Y(!0),children:"手动创建"})]})]}),0===s.length?(0,l.jsx)(m.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsx)(t.o,{children:(0,l.jsxs)(a.B,{align:"center",gap:"md",children:[(0,l.jsx)(b.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(h.h,{order:3,ta:"center",children:"还没有知识框架"}),(0,l.jsx)(d.E,{c:"dimmed",ta:"center",maw:400,children:"创建您的第一个知识框架来组织和管理知识体系"}),(0,l.jsxs)(c.Y,{children:[(0,l.jsx)(x.$,{leftSection:(0,l.jsx)(A.A,{size:16}),variant:"gradient",gradient:{from:"violet",to:"purple"},onClick:()=>P(!0),children:"AI 辅助创建"}),(0,l.jsx)(x.$,{leftSection:(0,l.jsx)(z.A,{size:16}),variant:"light",onClick:()=>Y(!0),children:"手动创建"})]})]})})}):(0,l.jsx)(j.x,{children:s.map(e=>(0,l.jsx)(j.x.Col,{span:{base:12,md:6,lg:4},children:(0,l.jsx)(m.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,h:"100%",children:(0,l.jsxs)(a.B,{gap:"sm",h:"100%",children:[(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsx)(u.E,{variant:"light",color:e.local_only?"orange":"green",size:"sm",children:e.local_only?"本地":"已同步"}),(0,l.jsx)(u.E,{variant:"outline",size:"xs",children:e.domain})]}),(0,l.jsxs)(o.a,{style:{flex:1},children:[(0,l.jsx)(h.h,{order:4,mb:"xs",children:e.title}),(0,l.jsx)(d.E,{size:"sm",c:"dimmed",mb:"sm",lineClamp:3,children:e.description})]}),(0,l.jsx)(p.c,{}),(0,l.jsxs)(c.Y,{justify:"space-between",children:[(0,l.jsxs)(c.Y,{gap:"xs",children:[(0,l.jsx)(g.M,{variant:"light",size:"sm",onClick:()=>{D(e),null==i||i(e)},children:(0,l.jsx)(S.A,{size:14})}),(0,l.jsx)(g.M,{variant:"light",size:"sm",onClick:()=>{},children:(0,l.jsx)(I.A,{size:14})})]}),(0,l.jsx)(g.M,{variant:"light",color:"red",size:"sm",onClick:()=>{},children:(0,l.jsx)(k.A,{size:14})})]})]})})},e.id))}),(0,l.jsx)(y.a,{opened:T,onClose:()=>Y(!1),title:"创建知识框架",size:"md",children:(0,l.jsxs)(a.B,{gap:"md",children:[(0,l.jsx)(w.k,{label:"标题",placeholder:"React 开发框架",value:$.title,onChange:e=>q({...$,title:e.target.value}),required:!0}),(0,l.jsx)(v.T,{label:"描述",placeholder:"一个完整的React开发学习框架",value:$.description,onChange:e=>q({...$,description:e.target.value}),minRows:3,required:!0}),(0,l.jsx)(w.k,{label:"领域",placeholder:"前端开发",value:$.domain,onChange:e=>q({...$,domain:e.target.value}),required:!0}),(0,l.jsx)(x.$,{onClick:Z,loading:E,children:"创建框架"})]})}),(0,l.jsx)(y.a,{opened:B,onClose:()=>P(!1),title:"AI 辅助创建知识框架",size:"md",children:(0,l.jsxs)(a.B,{gap:"md",children:[(0,l.jsx)(w.k,{label:"标题",placeholder:"React 开发框架",value:O.title,onChange:e=>F({...O,title:e.target.value}),required:!0}),(0,l.jsx)(v.T,{label:"描述",placeholder:"一个完整的React开发学习框架",value:O.description,onChange:e=>F({...O,description:e.target.value}),minRows:3,required:!0}),(0,l.jsx)(w.k,{label:"领域",placeholder:"前端开发",value:O.domain,onChange:e=>F({...O,domain:e.target.value}),required:!0}),(0,l.jsx)(w.k,{label:"目标用户",placeholder:"初学者/中级开发者/高级开发者",value:O.targetUser,onChange:e=>F({...O,targetUser:e.target.value})}),(0,l.jsx)(f.l,{label:"复杂度",value:O.complexity,onChange:e=>F({...O,complexity:e||"medium"}),data:[{value:"simple",label:"简单"},{value:"medium",label:"中等"},{value:"complex",label:"复杂"}]}),(0,l.jsx)(x.$,{onClick:G,loading:R,children:"AI 创建框架"})]})})]})};new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString()},2836:(e,i,s)=>{s.d(i,{V:()=>P});var l=s(7770),r=s(6354),n=s(2971),t=s(8582),a=s(3810),d=s(8024),c=s(2993),o=s(2109),h=s(6454),x=s(2238),m=s(202),j=s(7710),u=s(9768),p=s(8423),g=s(6907),y=s(3852),w=s(9310),v=s(9547),f=s(6476),b=s(3331),A=s(8419),z=s(1016),S=s(7597),I=s(8780),k=s(6484),C=s(5054),E=s(7775),_=s(1414),T=s(6239);let Y=e=>{let{title:i,description:s,icon:r,breadcrumbs:n,actions:a,onBack:o,children:h}=e;return(0,l.jsxs)(t.B,{gap:"lg",p:"md",h:"100%",children:[n&&n.length>0&&(0,l.jsx)(k.B,{separator:">",children:n.map((e,i)=>(0,l.jsxs)(C.M,{href:e.href,size:"sm",c:"dimmed",style:{textDecoration:"none"},children:[0===i&&(0,l.jsx)(_.A,{size:14,style:{marginRight:4}}),e.label]},i))}),(0,l.jsxs)(d.Y,{justify:"space-between",align:"flex-start",children:[(0,l.jsxs)(d.Y,{align:"flex-start",children:[o&&(0,l.jsx)(E.M,{variant:"light",size:"lg",onClick:o,style:{marginTop:4},children:(0,l.jsx)(T.A,{size:18})}),(0,l.jsxs)(d.Y,{align:"flex-start",children:[r&&(0,l.jsx)(m.a,{style:{marginTop:2},children:r}),(0,l.jsxs)(m.a,{children:[(0,l.jsx)(c.h,{order:2,mb:4*!!s,children:i}),s&&(0,l.jsx)(j.E,{c:"dimmed",size:"sm",children:s})]})]})]}),a&&(0,l.jsx)(d.Y,{children:a})]}),(0,l.jsx)(m.a,{style:{flex:1,overflow:"auto"},children:h})]})},B=async()=>{try{if(window.__TAURI__){let{invoke:e}=await s.e(379).then(s.bind(s,7379));return e}}catch(e){console.warn("Tauri API not available:",e)}return null},P=()=>{let[e,i]=(0,r.useState)({theme:"system",language:"zh-CN",autoSave:!0,defaultProvider:"",maxTokens:4e3,temperature:.7,enableTelemetry:!1}),[s,k]=(0,r.useState)(!1),[C,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{_()},[]);let _=async()=>{try{let e=await B();if(!e)return void console.warn("Tauri API not available, using default settings");let s=await e("get_settings");i(s)}catch(e){console.error("Failed to load settings:",e)}},T=async()=>{let i=await B();if(!i)return void alert("Tauri API 不可用，无法保存设置");k(!0);try{await i("save_settings",{settings:e}),E(!0),setTimeout(()=>E(!1),2e3)}catch(e){console.error("Failed to save settings:",e),alert("保存失败: ".concat(e))}finally{k(!1)}},P=(e,s)=>{i(i=>({...i,[e]:s}))},K=async()=>{await T(),s||I.$e.show({title:"保存成功",message:"设置已保存",color:"green"})};return(0,l.jsx)(Y,{title:"应用设置",description:"自定义您的应用体验",icon:(0,l.jsx)(y.A,{size:28,color:"var(--mantine-color-blue-6)"}),actions:(0,l.jsx)(n.$,{onClick:K,loading:s,color:C?"green":"blue",children:C?"已保存":"保存设置"}),children:(0,l.jsxs)(t.B,{gap:"lg",children:[(0,l.jsx)(a.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsxs)(d.Y,{children:[(0,l.jsx)(w.A,{size:20,color:"var(--mantine-color-blue-6)"}),(0,l.jsx)(c.h,{order:4,children:"外观设置"})]}),(0,l.jsx)(o.c,{}),(0,l.jsx)(h.l,{label:"主题",description:"选择应用的外观主题",value:e.theme,onChange:e=>P("theme",e||"system"),data:[{value:"light",label:"浅色"},{value:"dark",label:"深色"},{value:"system",label:"跟随系统"}]}),(0,l.jsx)(h.l,{label:"语言",description:"选择应用界面语言",value:e.language,onChange:e=>P("language",e||"zh-CN"),data:[{value:"zh-CN",label:"简体中文"},{value:"en-US",label:"English"}]})]})}),(0,l.jsx)(a.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsxs)(d.Y,{children:[(0,l.jsx)(v.A,{size:20,color:"var(--mantine-color-green-6)"}),(0,l.jsx)(c.h,{order:4,children:"AI 配置"})]}),(0,l.jsx)(o.c,{}),(0,l.jsx)(x.Q,{label:"最大 Token 数量",description:"控制 AI 响应的最大长度，较高的值会消耗更多 token",value:e.maxTokens,onChange:e=>P("maxTokens",e||4e3),min:100,max:32e3,step:100}),(0,l.jsxs)(m.a,{children:[(0,l.jsxs)(j.E,{size:"sm",fw:500,mb:"xs",children:["温度 (Temperature): ",e.temperature]}),(0,l.jsx)(u.A,{value:e.temperature,onChange:e=>P("temperature",e),min:0,max:2,step:.1,marks:[{value:0,label:"保守"},{value:1,label:"平衡"},{value:2,label:"创造性"}]}),(0,l.jsx)(j.E,{size:"xs",c:"dimmed",mt:"xs",children:"控制 AI 响应的随机性和创造性"})]})]})}),(0,l.jsx)(a.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsxs)(d.Y,{children:[(0,l.jsx)(y.A,{size:20,color:"var(--mantine-color-orange-6)"}),(0,l.jsx)(c.h,{order:4,children:"行为设置"})]}),(0,l.jsx)(o.c,{}),(0,l.jsxs)(d.Y,{justify:"space-between",children:[(0,l.jsxs)(m.a,{children:[(0,l.jsx)(j.E,{size:"sm",fw:500,children:"自动保存"}),(0,l.jsx)(j.E,{size:"xs",c:"dimmed",children:"自动保存聊天记录和设置"})]}),(0,l.jsx)(p.d,{checked:e.autoSave,onChange:e=>P("autoSave",e.currentTarget.checked)})]}),(0,l.jsxs)(d.Y,{justify:"space-between",children:[(0,l.jsxs)(m.a,{children:[(0,l.jsx)(j.E,{size:"sm",fw:500,children:"启用遥测"}),(0,l.jsx)(j.E,{size:"xs",c:"dimmed",children:"帮助改进应用体验（匿名数据）"})]}),(0,l.jsx)(p.d,{checked:e.enableTelemetry,onChange:e=>P("enableTelemetry",e.currentTarget.checked)})]})]})}),(0,l.jsx)(a.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:(0,l.jsxs)(t.B,{gap:"md",children:[(0,l.jsxs)(d.Y,{children:[(0,l.jsx)(f.A,{size:20,color:"var(--mantine-color-violet-6)"}),(0,l.jsx)(c.h,{order:4,children:"数据管理"})]}),(0,l.jsx)(o.c,{}),(0,l.jsx)(g.F,{icon:(0,l.jsx)(b.A,{size:16}),color:"blue",variant:"light",children:(0,l.jsx)(j.E,{size:"sm",children:"数据管理功能可以帮助您备份和恢复应用数据"})}),(0,l.jsxs)(d.Y,{justify:"space-between",children:[(0,l.jsxs)(m.a,{children:[(0,l.jsx)(j.E,{size:"sm",fw:500,children:"导出数据"}),(0,l.jsx)(j.E,{size:"xs",c:"dimmed",children:"导出您的聊天记录和设置"})]}),(0,l.jsx)(n.$,{variant:"light",leftSection:(0,l.jsx)(A.A,{size:16}),size:"sm",children:"导出"})]}),(0,l.jsxs)(d.Y,{justify:"space-between",children:[(0,l.jsxs)(m.a,{children:[(0,l.jsx)(j.E,{size:"sm",fw:500,children:"导入数据"}),(0,l.jsx)(j.E,{size:"xs",c:"dimmed",children:"从备份文件恢复数据"})]}),(0,l.jsx)(n.$,{variant:"light",leftSection:(0,l.jsx)(z.A,{size:16}),size:"sm",children:"导入"})]}),(0,l.jsx)(o.c,{}),(0,l.jsxs)(d.Y,{justify:"space-between",children:[(0,l.jsxs)(m.a,{children:[(0,l.jsx)(j.E,{size:"sm",fw:500,c:"red",children:"清除所有数据"}),(0,l.jsx)(j.E,{size:"xs",c:"dimmed",children:"删除所有聊天记录、API Key 和设置"})]}),(0,l.jsx)(n.$,{variant:"light",color:"red",leftSection:(0,l.jsx)(S.A,{size:16}),size:"sm",onClick:()=>{confirm("确定要清除所有数据吗？此操作不可恢复！")&&I.$e.show({title:"功能开发中",message:"此功能正在开发中...",color:"orange"})},children:"清除"})]})]})})]})})}},6312:(e,i,s)=>{s.d(i,{z:()=>E});var l=s(7770),r=s(6354),n=s(8582),t=s(8024),a=s(202),d=s(2993),c=s(7710),o=s(2971),h=s(7935),x=s(3810),m=s(2055),j=s(7775),u=s(9157),p=s(9764),g=s(6451),y=s(6454),w=s(1421),v=s(9547),f=s(2199),b=s(7998),A=s(435),z=s(7597),S=s(4171);let I=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;switch(e){case"robot":return(0,l.jsx)(v.A,{size:i});case"brain":return(0,l.jsx)(f.A,{size:i});default:return(0,l.jsx)(b.A,{size:i})}},k=async()=>{try{if(window.__TAURI__){let{invoke:e}=await s.e(379).then(s.bind(s,7379));return e}}catch(e){console.warn("Tauri API not available:",e)}return null},C=[{id:"openai",name:"OpenAI",description:"GPT-4, GPT-3.5 等模型",icon:"robot",models:[{id:"gpt-4",name:"GPT-4",contextLength:8192},{id:"gpt-4-turbo",name:"GPT-4 Turbo",contextLength:128e3},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",contextLength:4096}],requiredFields:[{key:"apiKey",label:"API Key",type:"password",required:!0,placeholder:"sk-..."},{key:"baseUrl",label:"Base URL (可选)",type:"url",required:!1,placeholder:"https://api.openai.com/v1"}]},{id:"anthropic",name:"Anthropic",description:"Claude 系列模型",icon:"brain",models:[{id:"claude-3-opus-20240229",name:"Claude 3 Opus",contextLength:2e5},{id:"claude-3-sonnet-20240229",name:"Claude 3 Sonnet",contextLength:2e5},{id:"claude-3-haiku-20240307",name:"Claude 3 Haiku",contextLength:2e5}],requiredFields:[{key:"apiKey",label:"API Key",type:"password",required:!0,placeholder:"sk-ant-..."}]}],E=()=>{var e;let[i,s]=(0,r.useState)([]),[v,f]=(0,r.useState)(!1),[E,_]=(0,r.useState)(null),[T,Y]=(0,r.useState)({}),[B,P]=(0,r.useState)(!1),[K,D]=(0,r.useState)({});(0,r.useEffect)(()=>{$()},[]);let $=async()=>{try{let e=await k();if(!e)return void console.warn("Tauri API not available");let i=await e("get_api_keys");s(i)}catch(e){console.error("Failed to load API keys:",e)}},q=()=>{f(!0),_(null),Y({})},O=(e,i)=>{Y(s=>({...s,[e]:i}))},F=async()=>{if(E&&T.apiKey){P(!0);try{let e=await k();if(!e)return void alert("Tauri API 不可用，无法测试 API Key");let i=await e("test_api_key",{provider:E.id,apiKey:T.apiKey,baseUrl:T.baseUrl||null});D(e=>({...e,[E.id]:i})),i?alert("API Key 测试成功！"):alert("API Key 测试失败，请检查密钥是否正确。")}catch(e){console.error("API Key test failed:",e),alert("测试失败: ".concat(e))}finally{P(!1)}}},R=async()=>{var e;if(!E||!T.apiKey)return;let s=await k();if(!s)return void alert("Tauri API 不可用，无法保存 API Key");let l={id:Date.now().toString(),name:T.name||"".concat(E.name," Key"),provider:E.id,apiKey:T.apiKey,baseUrl:T.baseUrl||void 0,model:T.model||(null==(e=E.models[0])?void 0:e.id),isDefault:0===i.filter(e=>e.provider===E.id).length,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{await s("save_api_key",{apiKey:l}),await $(),f(!1),_(null),Y({})}catch(e){console.error("Failed to save API key:",e),alert("保存失败: ".concat(e))}},U=async e=>{if(!confirm("确定要删除这个 API Key 吗？"))return;let i=await k();if(!i)return void alert("Tauri API 不可用，无法删除 API Key");try{await i("delete_api_key",{keyId:e}),await $()}catch(e){console.error("Failed to delete API key:",e),alert("删除失败: ".concat(e))}},L=async e=>{let i=await k();if(!i)return void alert("Tauri API 不可用，无法更新 API Key");let s={...e,isDefault:!e.isDefault,updatedAt:new Date().toISOString()};try{await i("save_api_key",{apiKey:s}),await $()}catch(e){console.error("Failed to update API key:",e)}};return(0,l.jsxs)(n.B,{gap:"lg",p:"md",children:[(0,l.jsxs)(t.Y,{justify:"space-between",children:[(0,l.jsxs)(t.Y,{children:[(0,l.jsx)(b.A,{size:28,color:"var(--mantine-color-blue-6)"}),(0,l.jsxs)(a.a,{children:[(0,l.jsx)(d.h,{order:2,children:"API Key 管理"}),(0,l.jsx)(c.E,{c:"dimmed",children:"管理您的 AI 服务提供商 API 密钥"})]})]}),(0,l.jsx)(o.$,{leftSection:(0,l.jsx)(A.A,{size:16}),onClick:q,children:"添加 API Key"})]}),(0,l.jsx)(h.x,{children:i.map(e=>{let i=C.find(i=>i.id===e.provider);return(0,l.jsx)(h.x.Col,{span:{base:12,md:6,lg:4},children:(0,l.jsxs)(x.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,h:"100%",children:[(0,l.jsxs)(t.Y,{justify:"space-between",mb:"md",children:[(0,l.jsxs)(t.Y,{children:[(null==i?void 0:i.icon)||(0,l.jsx)(b.A,{size:24}),(0,l.jsxs)(a.a,{children:[(0,l.jsx)(c.E,{fw:500,children:e.name}),(0,l.jsx)(c.E,{size:"sm",c:"dimmed",children:null==i?void 0:i.name})]})]}),e.isDefault&&(0,l.jsx)(m.E,{variant:"light",color:"blue",size:"sm",children:"默认"})]}),(0,l.jsxs)(n.B,{gap:"xs",mb:"md",children:[(0,l.jsxs)(t.Y,{justify:"space-between",children:[(0,l.jsx)(c.E,{size:"sm",c:"dimmed",children:"API Key:"}),(0,l.jsxs)(c.E,{size:"sm",ff:"monospace",children:[e.apiKey.substring(0,8),"...",e.apiKey.slice(-4)]})]}),e.model&&(0,l.jsxs)(t.Y,{justify:"space-between",children:[(0,l.jsx)(c.E,{size:"sm",c:"dimmed",children:"模型:"}),(0,l.jsx)(c.E,{size:"sm",children:e.model})]}),(0,l.jsxs)(t.Y,{justify:"space-between",children:[(0,l.jsx)(c.E,{size:"sm",c:"dimmed",children:"状态:"}),(0,l.jsx)(m.E,{variant:"light",color:e.isActive?"green":"gray",size:"sm",children:e.isActive?"活跃":"禁用"})]})]}),(0,l.jsxs)(t.Y,{gap:"xs",children:[(0,l.jsx)(o.$,{variant:"light",size:"xs",onClick:()=>L(e),style:{flex:1},children:e.isDefault?"取消默认":"设为默认"}),(0,l.jsx)(j.M,{variant:"light",color:"red",onClick:()=>U(e.id),children:(0,l.jsx)(z.A,{size:16})})]})]})},e.id)})}),v&&(0,l.jsxs)(x.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[(0,l.jsx)(d.h,{order:3,mb:"md",children:"添加新的 API Key"}),E?(0,l.jsxs)(n.B,{gap:"md",children:[(0,l.jsxs)(t.Y,{mb:"md",children:[I(E.icon),(0,l.jsxs)(a.a,{children:[(0,l.jsx)(c.E,{fw:500,children:E.name}),(0,l.jsx)(c.E,{size:"sm",c:"dimmed",children:E.description})]})]}),(0,l.jsx)(p.k,{label:"配置名称",placeholder:"".concat(E.name," 配置"),value:T.name||"",onChange:e=>O("name",e.currentTarget.value)}),E.requiredFields.map(e=>(0,l.jsxs)(a.a,{children:["password"===e.type?(0,l.jsx)(g.y,{label:(0,l.jsxs)(t.Y,{gap:"xs",children:[(0,l.jsx)(c.E,{children:e.label}),e.required&&(0,l.jsx)(c.E,{c:"red",children:"*"})]}),placeholder:e.placeholder,value:T[e.key]||"",onChange:i=>O(e.key,i.currentTarget.value),required:e.required}):(0,l.jsx)(p.k,{label:(0,l.jsxs)(t.Y,{gap:"xs",children:[(0,l.jsx)(c.E,{children:e.label}),e.required&&(0,l.jsx)(c.E,{c:"red",children:"*"})]}),type:e.type,placeholder:e.placeholder,value:T[e.key]||"",onChange:i=>O(e.key,i.currentTarget.value),required:e.required}),e.description&&(0,l.jsx)(c.E,{size:"xs",c:"dimmed",mt:"xs",children:e.description})]},e.key)),(0,l.jsx)(y.l,{label:"默认模型",value:T.model||(null==(e=E.models[0])?void 0:e.id)||"",onChange:e=>O("model",e||""),data:E.models.map(e=>({value:e.id,label:e.name}))}),(0,l.jsxs)(t.Y,{justify:"flex-end",mt:"md",children:[(0,l.jsx)(o.$,{variant:"subtle",onClick:()=>{f(!1),_(null),Y({})},children:"取消"}),(0,l.jsx)(o.$,{variant:"light",leftSection:(0,l.jsx)(S.A,{size:16}),onClick:F,disabled:!T.apiKey||B,loading:B,children:"测试连接"}),(0,l.jsx)(o.$,{onClick:R,disabled:!T.apiKey,children:"保存"})]})]}):(0,l.jsxs)(n.B,{gap:"md",children:[(0,l.jsx)(c.E,{c:"dimmed",children:"选择 AI 服务提供商："}),(0,l.jsx)(h.x,{children:C.map(e=>(0,l.jsx)(h.x.Col,{span:{base:12,sm:6},children:(0,l.jsx)(u.t,{p:"md",withBorder:!0,style:{cursor:"pointer"},onClick:()=>{_(e),Y({})},className:"hover:shadow-md transition-shadow",children:(0,l.jsxs)(t.Y,{children:[I(e.icon),(0,l.jsxs)(a.a,{children:[(0,l.jsx)(c.E,{fw:500,children:e.name}),(0,l.jsx)(c.E,{size:"sm",c:"dimmed",children:e.description})]})]})})},e.id))})]})]}),0===i.length&&!v&&(0,l.jsx)(x.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsx)(w.o,{children:(0,l.jsxs)(n.B,{align:"center",gap:"md",children:[(0,l.jsx)(b.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(d.h,{order:3,ta:"center",children:"还没有 API Key"}),(0,l.jsx)(c.E,{c:"dimmed",ta:"center",maw:400,children:"添加您的第一个 AI 服务提供商 API Key 来开始使用"}),(0,l.jsx)(o.$,{leftSection:(0,l.jsx)(A.A,{size:16}),onClick:q,children:"添加 API Key"})]})})})]})}},8796:(e,i,s)=>{s.d(i,{g:()=>Y});var l=s(7770),r=s(6354),n=s(8582),t=s(8024),a=s(202),d=s(2993),c=s(7710),o=s(2971),h=s(9764),x=s(9822),m=s(3810),j=s(1421),u=s(7935),p=s(2055),g=s(9157),y=s(2109),w=s(7775),v=s(5864),f=s(8732),b=s(6454),A=s(4842),z=s(9547),S=s(435),I=s(3319),k=s(7044),C=s(591),E=s(6284),_=s(8780);let T=[{id:1,title:"文章写作助手",description:"帮助您创作高质量的文章内容",category:"写作",template:"请帮我写一篇关于 {主题} 的文章，要求：\n1. 结构清晰，逻辑严谨\n2. 内容深入，观点独特\n3. 语言流畅，易于理解\n4. 字数控制在 {字数} 字左右"},{id:2,title:"代码审查专家",description:"专业的代码审查和优化建议",category:"编程",template:"请审查以下代码并提供改进建议：\n\n```{编程语言}\n{代码内容}\n```\n\n请从以下角度分析：\n1. 代码质量和可读性\n2. 性能优化建议\n3. 安全性考虑\n4. 最佳实践建议"},{id:3,title:"数据分析师",description:"专业的数据分析和洞察提取",category:"分析",template:"请分析以下数据并提供洞察：\n\n{数据描述}\n\n分析要求：\n1. 识别关键趋势和模式\n2. 提供数据驱动的洞察\n3. 给出可行的建议\n4. 用图表或可视化方式展示结果"},{id:4,title:"翻译专家",description:"专业的多语言翻译服务",category:"翻译",template:"请将以下内容从 {源语言} 翻译成 {目标语言}，要求：\n1. 准确传达原文意思\n2. 符合目标语言表达习惯\n3. 保持原文的语气和风格\n\n原文：\n{待翻译内容}"},{id:5,title:"学习助手",description:"帮助理解和学习复杂概念",category:"教育",template:"请帮我理解 {概念/主题}，要求：\n1. 用简单易懂的语言解释\n2. 提供具体的例子\n3. 指出重点和难点\n4. 给出学习建议\n\n我的背景：{学习背景}"}],Y=()=>{let[e,i]=(0,r.useState)("全部"),[s,Y]=(0,r.useState)(""),[B,P]=(0,r.useState)(null),[K,D]=(0,r.useState)(!1),[$,q]=(0,r.useState)(!1),O=["全部","写作","编程","分析","翻译","教育"],F=T.filter(i=>{let l="全部"===e||i.category===e,r=i.title.toLowerCase().includes(s.toLowerCase())||i.description.toLowerCase().includes(s.toLowerCase());return l&&r}),R=e=>{navigator.clipboard.writeText(e),_.$e.show({title:"复制成功",message:"模板已复制到剪贴板",color:"green"})};return(0,l.jsxs)(n.B,{gap:"lg",p:"md",children:[(0,l.jsxs)(t.Y,{justify:"space-between",children:[(0,l.jsxs)(t.Y,{children:[(0,l.jsx)(A.A,{size:28,color:"var(--mantine-color-green-6)"}),(0,l.jsxs)(a.a,{children:[(0,l.jsx)(d.h,{order:2,children:"提示词模板库"}),(0,l.jsx)(c.E,{c:"dimmed",size:"sm",children:"精选的 AI 提示词模板，提升您的工作效率"})]})]}),(0,l.jsxs)(t.Y,{children:[(0,l.jsx)(o.$,{leftSection:(0,l.jsx)(z.A,{size:16}),variant:"gradient",gradient:{from:"green",to:"teal"},children:"AI 生成"}),(0,l.jsx)(o.$,{leftSection:(0,l.jsx)(S.A,{size:16}),onClick:()=>q(!0),children:"创建模板"})]})]}),(0,l.jsx)(t.Y,{children:(0,l.jsx)(h.k,{placeholder:"搜索模板...",value:s,onChange:e=>Y(e.currentTarget.value),leftSection:(0,l.jsx)(I.A,{size:16}),style:{flex:1}})}),(0,l.jsx)(x.t,{value:e,onChange:e=>i(e||"全部"),children:(0,l.jsx)(x.t.List,{children:O.map(e=>(0,l.jsx)(x.t.Tab,{value:e,children:e},e))})}),0===F.length?(0,l.jsx)(m.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsx)(j.o,{children:(0,l.jsxs)(n.B,{align:"center",gap:"md",children:[(0,l.jsx)(A.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(d.h,{order:3,ta:"center",children:"没有找到匹配的模板"}),(0,l.jsx)(c.E,{c:"dimmed",ta:"center",maw:400,children:"尝试调整搜索条件或选择其他分类"})]})})}):(0,l.jsx)(u.x,{children:F.map(e=>(0,l.jsx)(u.x.Col,{span:{base:12,md:6,lg:4},children:(0,l.jsx)(m.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,h:"100%",children:(0,l.jsxs)(n.B,{gap:"sm",h:"100%",children:[(0,l.jsx)(t.Y,{justify:"space-between",children:(0,l.jsx)(p.E,{variant:"light",color:"blue",size:"sm",children:e.category})}),(0,l.jsxs)(a.a,{style:{flex:1},children:[(0,l.jsx)(d.h,{order:4,mb:"xs",children:e.title}),(0,l.jsx)(c.E,{size:"sm",c:"dimmed",mb:"sm",lineClamp:2,children:e.description}),(0,l.jsx)(g.t,{p:"sm",bg:"gray.0",radius:"md",mb:"sm",children:(0,l.jsx)(c.E,{size:"xs",c:"dimmed",lineClamp:4,style:{fontFamily:"monospace"},children:e.template})})]}),(0,l.jsx)(y.c,{}),(0,l.jsxs)(t.Y,{justify:"space-between",children:[(0,l.jsxs)(t.Y,{gap:"xs",children:[(0,l.jsx)(w.M,{variant:"light",size:"sm",onClick:()=>{P(e),D(!0)},children:(0,l.jsx)(k.A,{size:14})}),(0,l.jsx)(w.M,{variant:"light",size:"sm",onClick:()=>{},children:(0,l.jsx)(C.A,{size:14})})]}),(0,l.jsx)(o.$,{size:"xs",leftSection:(0,l.jsx)(E.A,{size:12}),onClick:()=>R(e.template),children:"复制"})]})]})})},e.id))}),(0,l.jsx)(v.a,{opened:K,onClose:()=>D(!1),title:(null==B?void 0:B.title)||"模板详情",size:"lg",children:B&&(0,l.jsxs)(n.B,{gap:"md",children:[(0,l.jsx)(t.Y,{children:(0,l.jsx)(p.E,{color:"blue",children:B.category})}),(0,l.jsx)(c.E,{children:B.description}),(0,l.jsxs)(a.a,{children:[(0,l.jsx)(c.E,{fw:500,mb:"sm",children:"模板内容："}),(0,l.jsx)(g.t,{p:"md",withBorder:!0,bg:"gray.0",children:(0,l.jsx)(c.E,{size:"sm",style:{whiteSpace:"pre-wrap",fontFamily:"monospace"},children:B.template})})]}),(0,l.jsx)(t.Y,{justify:"flex-end",children:(0,l.jsx)(o.$,{leftSection:(0,l.jsx)(E.A,{size:16}),onClick:()=>{R(B.template),D(!1)},children:"复制模板"})})]})}),(0,l.jsx)(v.a,{opened:$,onClose:()=>q(!1),title:"创建提示词模板",size:"lg",children:(0,l.jsxs)(n.B,{gap:"md",children:[(0,l.jsx)(h.k,{label:"模板标题",placeholder:"输入模板标题",required:!0}),(0,l.jsx)(f.T,{label:"模板描述",placeholder:"描述这个模板的用途和特点",minRows:2,required:!0}),(0,l.jsx)(b.l,{label:"分类",placeholder:"选择分类",data:O.filter(e=>"全部"!==e),required:!0}),(0,l.jsx)(f.T,{label:"模板内容",placeholder:"输入提示词模板内容，使用 {参数名} 表示可替换的参数",minRows:6,required:!0}),(0,l.jsxs)(t.Y,{justify:"flex-end",mt:"md",children:[(0,l.jsx)(o.$,{variant:"light",onClick:()=>q(!1),children:"取消"}),(0,l.jsx)(o.$,{children:"创建模板"})]})]})})]})}},8969:(e,i,s)=>{s.d(i,{C:()=>I});var l=s(7770),r=s(6354),n=s(202),t=s(3810),a=s(1421),d=s(8582),c=s(2993),o=s(7710),h=s(2971),x=s(9157),m=s(8024),j=s(6454),u=s(7775),p=s(4611),g=s(2055),y=s(3355),w=s(8732),v=s(9547),f=s(3852),b=s(1870),A=s(7597),z=s(3545);let S=async()=>{try{if(window.__TAURI__){let{invoke:e}=await s.e(379).then(s.bind(s,7379));return e}}catch(e){console.warn("Tauri API not available:",e)}return null},I=()=>{let[e,i]=(0,r.useState)([]),[s,I]=(0,r.useState)(null),[k,C]=(0,r.useState)([]),[E,_]=(0,r.useState)(""),[T,Y]=(0,r.useState)(!1),B=(0,r.useRef)(null);(0,r.useEffect)(()=>{P()},[]),(0,r.useEffect)(()=>{K()},[k]);let P=async()=>{try{let e=await S();if(!e){console.warn("Tauri API not available, using mock data");let e=[{id:"mock-1",name:"Mock OpenAI",provider:"openai",apiKey:"mock-key",baseUrl:void 0,model:"gpt-3.5-turbo",isDefault:!0,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}];i(e),I(e[0]);return}let s=await e("get_api_keys");i(s);let l=s.find(e=>e.isDefault&&e.isActive);l?I(l):s.length>0&&I(s[0])}catch(e){console.error("Failed to load API keys:",e)}},K=()=>{var e;null==(e=B.current)||e.scrollIntoView({behavior:"smooth"})},D=async()=>{if(!E.trim()||!s||T)return;let e={id:Date.now().toString(),role:"user",content:E.trim(),timestamp:new Date().toISOString()};C(i=>[...i,e]),_(""),Y(!0);try{let i,l=await S();if(l){let r=[...k,e].map(e=>({role:e.role,content:e.content}));i=await l("chat_with_ai",{provider:s.provider,apiKey:s.apiKey,model:s.model||"gpt-3.5-turbo",messages:r,baseUrl:s.baseUrl||null})}else await new Promise(e=>setTimeout(e,1e3)),i='这是一个模拟回复，因为 Tauri API 不可用。您的消息是："'.concat(e.content,'"');let r={id:(Date.now()+1).toString(),role:"assistant",content:i,timestamp:new Date().toISOString(),model:s.model};C(e=>[...e,r])}catch(i){console.error("Chat failed:",i);let e={id:(Date.now()+1).toString(),role:"assistant",content:"抱歉，发生了错误：".concat(i),timestamp:new Date().toISOString()};C(i=>[...i,e])}finally{Y(!1)}};return 0===e.length?(0,l.jsx)(n.a,{p:"lg",children:(0,l.jsx)(t.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsx)(a.o,{children:(0,l.jsxs)(d.B,{align:"center",gap:"md",children:[(0,l.jsx)(v.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(c.h,{order:3,ta:"center",children:"需要配置 API Key"}),(0,l.jsx)(o.E,{c:"dimmed",ta:"center",maw:400,children:"请先在 API Key 管理页面添加至少一个 AI 服务提供商的密钥"}),(0,l.jsx)(h.$,{leftSection:(0,l.jsx)(f.A,{size:16}),children:"前往配置"})]})})})}):(0,l.jsxs)(d.B,{h:"100vh",gap:0,children:[(0,l.jsx)(x.t,{p:"md",shadow:"sm",withBorder:!0,children:(0,l.jsxs)(m.Y,{justify:"space-between",children:[(0,l.jsxs)(m.Y,{children:[(0,l.jsx)(b.A,{size:24,color:"var(--mantine-color-blue-6)"}),(0,l.jsx)(c.h,{order:3,children:"AI 聊天"}),(0,l.jsx)(j.l,{placeholder:"选择 API Key",value:(null==s?void 0:s.id)||null,onChange:i=>{I(e.find(e=>e.id===i)||null)},data:e.map(e=>({value:e.id,label:"".concat(e.name," (").concat(e.provider,")")})),w:250})]}),(0,l.jsx)(u.M,{variant:"light",color:"red",onClick:()=>{confirm("确定要清除聊天记录吗？")&&C([])},disabled:0===k.length,children:(0,l.jsx)(A.A,{size:16})})]})}),(0,l.jsx)(p.F,{style:{flex:1},p:"md",bg:"gray.0",children:0===k.length?(0,l.jsx)(a.o,{h:"100%",children:(0,l.jsxs)(d.B,{align:"center",gap:"md",children:[(0,l.jsx)(b.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(c.h,{order:3,ta:"center",children:"开始对话"}),(0,l.jsx)(o.E,{c:"dimmed",ta:"center",maw:400,children:"向 AI 提问任何问题，开始您的智能对话"})]})}):(0,l.jsxs)(d.B,{gap:"md",children:[k.map(e=>(0,l.jsx)(m.Y,{justify:"user"===e.role?"flex-end":"flex-start",align:"flex-start",children:(0,l.jsxs)(x.t,{p:"md",radius:"lg",shadow:"sm",style:{maxWidth:"70%",backgroundColor:"user"===e.role?"var(--mantine-color-blue-6)":"white",color:"user"===e.role?"white":"inherit"},children:[(0,l.jsx)(o.E,{style:{whiteSpace:"pre-wrap"},children:e.content}),(0,l.jsxs)(m.Y,{justify:"space-between",mt:"xs",children:[(0,l.jsx)(o.E,{size:"xs",c:"user"===e.role?"blue.1":"dimmed",children:new Date(e.timestamp).toLocaleTimeString()}),e.model&&(0,l.jsx)(g.E,{size:"xs",variant:"light",children:e.model})]})]})},e.id)),T&&(0,l.jsx)(m.Y,{justify:"flex-start",children:(0,l.jsx)(x.t,{p:"md",radius:"lg",shadow:"sm",bg:"white",children:(0,l.jsxs)(m.Y,{gap:"sm",children:[(0,l.jsx)(y.a,{size:"sm"}),(0,l.jsx)(o.E,{c:"dimmed",children:"AI 正在思考..."})]})})}),(0,l.jsx)("div",{ref:B})]})}),(0,l.jsx)(x.t,{p:"md",shadow:"sm",withBorder:!0,children:(0,l.jsxs)(d.B,{gap:"xs",children:[(0,l.jsxs)(m.Y,{align:"flex-end",gap:"sm",children:[(0,l.jsx)(w.T,{value:E,onChange:e=>_(e.currentTarget.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),D())},placeholder:"输入您的消息... (Shift+Enter 换行，Enter 发送)",autosize:!0,minRows:1,maxRows:4,style:{flex:1},radius:"md"}),(0,l.jsx)(h.$,{onClick:D,disabled:!E.trim()||!s||T,loading:T,leftSection:(0,l.jsx)(z.A,{size:16}),children:"发送"})]}),s&&(0,l.jsxs)(o.E,{size:"xs",c:"dimmed",children:["使用 ",s.name," (",s.model||"default",")"]})]})})]})}}}]);