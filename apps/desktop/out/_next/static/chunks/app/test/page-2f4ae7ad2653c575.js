(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{942:(e,t,r)=>{"use strict";function n(){let e=window;if(void 0!==e.__TAURI__||void 0!==e.__TAURI_INTERNALS__||window.navigator.userAgent.includes("Tauri"))return!0;try{if(e.location&&"tauri:"===e.location.protocol)return!0}catch(e){}return"file:"===window.location.protocol||"tauri:"===window.location.protocol}function o(){return{isTauri:n(),isDev:!1,isBuild:!0,userAgent:window.navigator.userAgent,platform:window.navigator.platform}}async function a(){if(n())return!0;try{let{invoke:e}=await r.e(379).then(r.bind(r,7379));if(e)return await e("greet"),!0}catch(e){console.warn("Tauri API test failed:",e)}return!1}async function l(){try{if(await a()){let{invoke:e}=await r.e(379).then(r.bind(r,7379)),{getCurrentWindow:t}=await r.e(381).then(r.bind(r,9381)),n=t();return{invoke:e,currentWindow:n}}}catch(e){console.warn("Failed to import Tauri API:",e)}return{invoke:null,currentWindow:null}}function i(){let e=o();console.log("\uD83D\uDD0D Environment Info:",e),e.isTauri?console.log("✅ Running in Tauri desktop app"):console.log("\uD83C\uDF10 Running in web browser")}r.d(t,{XI:()=>a,cR:()=>o,uL:()=>i,vo:()=>n,xU:()=>l})},1274:(e,t,r)=>{"use strict";r.d(t,{$n:()=>o,Zp:()=>a,Wu:()=>i,aR:()=>l});var n=r(7770);r(6354);let o=e=>{let{variant:t="primary",size:r="md",className:o="",children:a,...l}=e,i="".concat("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500"}[t]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r]," ").concat(o);return(0,n.jsx)("button",{className:i,...l,children:a})},a=e=>{let{children:t,className:r=""}=e;return(0,n.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 ".concat(r),children:t})},l=e=>{let{children:t,className:r=""}=e;return(0,n.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 ".concat(r),children:t})},i=e=>{let{children:t,className:r=""}=e;return(0,n.jsx)("div",{className:"px-6 py-4 ".concat(r),children:t})}},1519:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(6354),o=r(942);let a=()=>{let[e,t]=(0,n.useState)(null),[r,a]=(0,n.useState)(!0),[l,i]=(0,n.useState)(!1),[s,c]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(0,o.uL)(),u()},[]);let u=async()=>{let e=await (0,o.XI)();c(e),console.log("\uD83D\uDD0D Tauri环境检测结果: ".concat(e?"✅ 是":"❌ 否")),await d()},d=async()=>{a(!0);try{let{invoke:e}=await (0,o.xU)();if(!s||!e){console.log("\uD83C\uDF10 Web环境：检查localStorage认证状态");let e=localStorage.getItem("auth_user"),r=localStorage.getItem("auth_token"),n=localStorage.getItem("auth_expires");if(e&&r&&n){let r=parseInt(n);if(Date.now()<r){let r=JSON.parse(e);t(r),i(!0),console.log("✅ Web环境：找到有效的认证数据")}else localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_expires"),console.log("⏰ Web环境：认证数据已过期，已清除")}else console.log("❌ Web环境：未找到认证数据");return}console.log("\uD83D\uDDA5️ Tauri环境：检查本地认证状态");let r=await e("get_auth_data");r?(t(r.user),i(!0),console.log("✅ Tauri环境：找到有效的认证数据")):console.log("❌ Tauri环境：未找到认证数据")}catch(e){console.error("❌ 检查认证状态失败:",e)}finally{a(!1)}},g=async()=>{try{let{invoke:e}=await (0,o.xU)();s&&e?(console.log("\uD83D\uDDA5️ Tauri环境：调用logout命令"),await e("logout")):(console.log("\uD83C\uDF10 Web环境：清除认证数据"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_expires"))}catch(e){console.error("❌ 登出失败:",e)}finally{t(null),i(!1),console.log("✅ 登出成功"),window.location.href="/login"}};return{user:e,isLoading:r,isAuthenticated:l,isTauriEnv:s,login:e=>{t(e),i(!0)},logout:g,checkAuthStatus:d}}},2091:(e,t,r)=>{Promise.resolve().then(r.bind(r,6411))},6411:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(7770);r(6354);var o=r(1519),a=r(1274);function l(){let{user:e,isAuthenticated:t,isLoading:r,logout:l}=(0,o.A)();return r?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsx)(a.Zp,{children:(0,n.jsxs)(a.Wu,{className:"text-center py-12",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"加载中..."})]})})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,n.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,n.jsx)(a.Zp,{children:(0,n.jsxs)(a.Wu,{className:"py-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"认证状态测试"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"认证状态:"})," ",t?"已登录":"未登录"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"加载状态:"})," ",r?"加载中":"已完成"]}),e&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"用户ID:"})," ",e.id]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"邮箱:"})," ",e.email]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"姓名:"})," ",e.name]}),e.avatar&&(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"头像:"})," ",e.avatar]})]}),(0,n.jsx)("div",{className:"pt-4",children:t?(0,n.jsx)(a.$n,{onClick:l,variant:"outline",children:"退出登录"}):(0,n.jsx)("p",{className:"text-gray-600",children:"请先登录"})})]})]})})})})}}},e=>{e.O(0,[854,162,358],()=>e(e.s=2091)),_N_E=e.O()}]);