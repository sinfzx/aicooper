(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{46:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>en});var l=i(7770),t=i(6354),r=i(1743),a=i(8024),n=i(2993),c=i(2055),o=i(8582),d=i(9412),h=i(7710),x=i(202),u=i(1870),j=i(2199),m=i(4842),g=i(7292),f=i(7998),p=i(3852),w=i(3562),y=i(9547),v=i(6312),b=i(2836),z=i(8969),E=i(1421),A=i(3355),S=i(8500),k=i(9157),C=i(9614),I=i(9946),T=i(3810),Y=i(2971),_=i(6907),N=i(6198),$=i(6880),B=i(7425),D=i(3331),R=i(7345),U=i(8780),F=i(1519);let O=()=>{let{user:e,logout:s,isLoading:i}=(0,F.A)(),[r,d]=(0,t.useState)(!1),u=async()=>{if(!r)try{d(!0),await s(),U.$e.show({title:"退出成功",message:"您已安全退出登录",color:"green"})}catch(e){console.error("Logout failed:",e),U.$e.show({title:"退出失败",message:"退出登录失败，请稍后重试",color:"red"})}finally{d(!1)}};return i?(0,l.jsx)(E.o,{h:"100vh",children:(0,l.jsxs)(o.B,{align:"center",children:[(0,l.jsx)(A.a,{size:"lg"}),(0,l.jsx)(h.E,{c:"dimmed",children:"加载用户信息..."})]})}):(0,l.jsx)(S.m,{size:"lg",py:"xl",children:(0,l.jsxs)(o.B,{gap:"xl",children:[(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(w.A,{size:32,color:"#228be6"}),(0,l.jsxs)(x.a,{children:[(0,l.jsx)(n.h,{order:2,children:"个人中心"}),(0,l.jsx)(h.E,{c:"dimmed",size:"sm",children:"管理您的账户信息和偏好设置"})]})]}),(0,l.jsx)(k.t,{shadow:"xs",p:"xl",radius:"md",className:"flat-card",children:(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(C.e,{size:80,radius:"md",src:null==e?void 0:e.avatar,color:"blue",children:(0,l.jsx)(w.A,{size:40})}),(0,l.jsxs)(o.B,{gap:"xs",flex:1,children:[(0,l.jsx)(n.h,{order:3,children:(null==e?void 0:e.name)||"未设置姓名"}),(0,l.jsxs)(a.Y,{gap:"xs",children:[(0,l.jsx)(N.A,{size:16}),(0,l.jsx)(h.E,{c:"dimmed",children:null==e?void 0:e.email})]}),(0,l.jsxs)(a.Y,{gap:"md",children:[(0,l.jsx)(c.E,{variant:"light",color:"blue",leftSection:(0,l.jsx)($.A,{size:12}),children:"已验证用户"}),(0,l.jsx)(c.E,{variant:"light",color:"green",children:"桌面应用"})]})]})]})}),(0,l.jsxs)(I.r,{cols:{base:1,sm:3},spacing:"md",children:[(0,l.jsx)(T.Z,{shadow:"xs",padding:"lg",radius:"md",className:"flat-card",children:(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsxs)(x.a,{children:[(0,l.jsx)(h.E,{c:"dimmed",size:"sm",children:"使用天数"}),(0,l.jsx)(h.E,{size:"xl",fw:700,c:"blue",children:"--"})]}),(0,l.jsx)(B.A,{size:24,color:"#228be6"})]})}),(0,l.jsx)(T.Z,{shadow:"xs",padding:"lg",radius:"md",className:"flat-card",children:(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsxs)(x.a,{children:[(0,l.jsx)(h.E,{c:"dimmed",size:"sm",children:"创建的模板"}),(0,l.jsx)(h.E,{size:"xl",fw:700,c:"green",children:"--"})]}),(0,l.jsx)(m.A,{size:24,color:"#40c057"})]})}),(0,l.jsx)(T.Z,{shadow:"xs",padding:"lg",radius:"md",className:"flat-card",children:(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsxs)(x.a,{children:[(0,l.jsx)(h.E,{c:"dimmed",size:"sm",children:"知识框架"}),(0,l.jsx)(h.E,{size:"xl",fw:700,c:"violet",children:"--"})]}),(0,l.jsx)(j.A,{size:24,color:"#7c3aed"})]})})]}),(0,l.jsxs)(k.t,{shadow:"xs",p:"xl",radius:"md",className:"flat-card",children:[(0,l.jsx)(n.h,{order:4,mb:"md",children:"快速操作"}),(0,l.jsxs)(I.r,{cols:{base:1,sm:2},spacing:"md",children:[(0,l.jsx)(Y.$,{variant:"light",leftSection:(0,l.jsx)(f.A,{size:18}),justify:"start",className:"flat-button",children:"管理 API 密钥"}),(0,l.jsx)(Y.$,{variant:"light",leftSection:(0,l.jsx)(p.A,{size:18}),justify:"start",className:"flat-button",children:"应用设置"}),(0,l.jsx)(Y.$,{variant:"light",leftSection:(0,l.jsx)(m.A,{size:18}),justify:"start",className:"flat-button",children:"我的模板"}),(0,l.jsx)(Y.$,{variant:"light",leftSection:(0,l.jsx)(j.A,{size:18}),justify:"start",className:"flat-button",children:"我的框架"})]})]}),(0,l.jsxs)(k.t,{shadow:"xs",p:"xl",radius:"md",className:"flat-card",children:[(0,l.jsx)(n.h,{order:4,mb:"md",children:"系统信息"}),(0,l.jsxs)(o.B,{gap:"sm",children:[(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsx)(h.E,{c:"dimmed",children:"应用版本"}),(0,l.jsx)(c.E,{variant:"outline",children:"v0.2.0"})]}),(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsx)(h.E,{c:"dimmed",children:"平台"}),(0,l.jsx)(c.E,{variant:"outline",color:"blue",children:"Tauri Desktop"})]}),(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsx)(h.E,{c:"dimmed",children:"环境"}),(0,l.jsx)(c.E,{variant:"outline",color:"green",children:"生产环境"})]}),(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsx)(h.E,{c:"dimmed",children:"最后登录"}),(0,l.jsx)(h.E,{size:"sm",children:"刚刚"})]})]})]}),(0,l.jsx)(_.F,{icon:(0,l.jsx)(D.A,{size:16}),title:"账户操作",color:"red",variant:"light",radius:"md",children:(0,l.jsxs)(a.Y,{justify:"space-between",mt:"md",children:[(0,l.jsxs)(x.a,{children:[(0,l.jsx)(h.E,{fw:500,children:"退出登录"}),(0,l.jsx)(h.E,{size:"sm",c:"dimmed",children:"退出当前账户，需要重新登录才能使用应用"})]}),(0,l.jsx)(Y.$,{color:"red",variant:"light",leftSection:(0,l.jsx)(R.A,{size:16}),onClick:u,loading:r,className:"flat-button",children:r?"退出中...":"退出登录"})]})}),(0,l.jsxs)(k.t,{p:"md",radius:"md",bg:"gray.0",children:[(0,l.jsx)(h.E,{ta:"center",size:"sm",c:"dimmed",children:"如果您遇到任何问题，请联系技术支持"}),(0,l.jsx)(h.E,{ta:"center",size:"sm",mt:"xs",children:(0,l.jsx)(h.E,{component:"a",href:"mailto:support@aiplatform.com",c:"blue",td:"none",style:{cursor:"pointer"},children:"support@aiplatform.com"})})]})]})})};var q=i(2689),P=i(7935),W=i(2109),L=i(7775),M=i(5864),Z=i(9764),G=i(8732),J=i(6454),H=i(3290),K=i(435),X=i(4977),V=i(9056),Q=i(3498),ee=i(7044),es=i(591),ei=i(1016),el=i(7597);let et=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{flowId:s,autoLoad:i=!0}=e,[l,r]=(0,t.useState)(null),[a,n]=(0,t.useState)([]),[c,o]=(0,t.useState)(!1),[d,h]=(0,t.useState)(null);(0,t.useEffect)(()=>{i&&(s?x(s):u())},[s,i]);let x=async e=>{o(!0),h(null);try{let s=await fetch("/api/flows/".concat(e)),i=await s.json();if(i.success)return r(i.data),i.data;throw Error(i.error)}catch(e){throw h(e instanceof Error?e.message:"Failed to load flow"),e}finally{o(!1)}},u=async()=>{o(!0),h(null);try{let e=await fetch("/api/flows"),s=await e.json();if(s.success)return n(s.data.items),s.data.items;throw Error(s.error)}catch(e){throw h(e instanceof Error?e.message:"Failed to load flows"),e}finally{o(!1)}},j=async e=>{o(!0),h(null);try{let s=await fetch("/api/flows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await s.json();if(i.success){let e=i.data;return n(s=>[e,...s]),e}throw Error(i.error)}catch(e){throw h(e instanceof Error?e.message:"Failed to create flow"),e}finally{o(!1)}},m=async(e,s)=>{o(!0),h(null);try{let i=await fetch("/api/flows/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await i.json();if(t.success){let s=t.data;return n(i=>i.map(i=>i.id===e?s:i)),(null==l?void 0:l.id)===e&&r(s),s}throw Error(t.error)}catch(e){throw h(e instanceof Error?e.message:"Failed to update flow"),e}finally{o(!1)}},g=async e=>{o(!0),h(null);try{let s=await fetch("/api/flows/".concat(e),{method:"DELETE"}),i=await s.json();if(i.success)n(s=>s.filter(s=>s.id!==e)),(null==l?void 0:l.id)===e&&r(null);else throw Error(i.error)}catch(e){throw h(e instanceof Error?e.message:"Failed to delete flow"),e}finally{o(!1)}},f=async e=>{let s=a.find(s=>s.id===e)||l;if(!s)throw Error("Flow not found");return j({...s,title:"".concat(s.title," (副本)"),id:void 0,createdAt:void 0,updatedAt:void 0})};return{flow:l,flows:a,loading:c,error:d,createFlow:j,updateFlow:m,deleteFlow:g,loadFlow:x,loadFlows:u,duplicateFlow:f}},er=e=>{let{onFlowSelect:s}=e,{flows:i,loading:r,createFlow:d,deleteFlow:u}=et(),[j,m]=(0,t.useState)(null),[f,p]=(0,t.useState)(!1),[w,v]=(0,t.useState)(!1),[b,z]=(0,t.useState)(!1),[S,C]=(0,t.useState)({title:"",description:"",difficulty:"medium"}),[I,N]=(0,t.useState)({title:"",description:"",goals:"",domain:"",difficulty:"medium",referenceUrls:""}),[$,B]=(0,t.useState)(!1),D=async()=>{try{await d(S),p(!1),C({title:"",description:"",difficulty:"medium"}),U.$e.show({title:"创建成功",message:"流程设计已创建",color:"green"})}catch(e){U.$e.show({title:"创建失败",message:"无法创建流程设计",color:"red"})}},R=async()=>{try{B(!0),await d({title:I.title,description:I.description,difficulty:I.difficulty,article:"# ".concat(I.title,"\n\n").concat(I.description),steps:[],tools:[],prerequisites:[],outcomes:[]}),v(!1),N({title:"",description:"",goals:"",domain:"",difficulty:"medium",referenceUrls:""}),U.$e.show({title:"AI 创建成功",message:"流程设计已通过 AI 辅助创建",color:"green"})}catch(e){U.$e.show({title:"AI 创建失败",message:e instanceof Error?e.message:"无法通过 AI 创建流程设计",color:"red"})}finally{B(!1)}},F=e=>{switch(e){case"easy":return"green";case"medium":return"yellow";case"hard":return"red";default:return"gray"}},O=e=>{switch(e){case"easy":return"简单";case"medium":return"中等";case"hard":return"困难";default:return"未知"}};return r?(0,l.jsx)(E.o,{h:400,children:(0,l.jsxs)(o.B,{align:"center",children:[(0,l.jsx)(A.a,{size:"lg"}),(0,l.jsx)(h.E,{c:"dimmed",children:"加载流程设计..."})]})}):(0,l.jsxs)(o.B,{gap:"lg",p:"md",children:[(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(g.A,{size:28,color:"var(--mantine-color-green-6)"}),(0,l.jsxs)(x.a,{children:[(0,l.jsx)(n.h,{order:2,children:"流程设计"}),(0,l.jsx)(h.E,{c:"dimmed",size:"sm",children:"创建和管理执行流程"})]})]}),(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(Y.$,{leftSection:(0,l.jsx)(y.A,{size:16}),variant:"gradient",gradient:{from:"green",to:"teal"},onClick:()=>v(!0),children:"AI 创建"}),(0,l.jsx)(Y.$,{leftSection:(0,l.jsx)(K.A,{size:16}),onClick:()=>p(!0),children:"手动创建"})]})]}),0===i.length?(0,l.jsx)(T.Z,{shadow:"sm",padding:"xl",radius:"md",withBorder:!0,children:(0,l.jsx)(E.o,{children:(0,l.jsxs)(o.B,{align:"center",gap:"md",children:[(0,l.jsx)(g.A,{size:64,color:"var(--mantine-color-gray-5)"}),(0,l.jsx)(n.h,{order:3,ta:"center",children:"还没有流程设计"}),(0,l.jsx)(h.E,{c:"dimmed",ta:"center",maw:400,children:"创建您的第一个流程设计来规划和执行复杂任务"}),(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(Y.$,{leftSection:(0,l.jsx)(y.A,{size:16}),variant:"gradient",gradient:{from:"green",to:"teal"},onClick:()=>v(!0),children:"AI 辅助创建"}),(0,l.jsx)(Y.$,{leftSection:(0,l.jsx)(K.A,{size:16}),variant:"light",onClick:()=>p(!0),children:"手动创建"})]})]})})}):(0,l.jsx)(P.x,{children:i.map(e=>(0,l.jsx)(P.x.Col,{span:{base:12,md:6,lg:4},children:(0,l.jsx)(T.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,h:"100%",children:(0,l.jsxs)(o.B,{gap:"sm",h:"100%",children:[(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsx)(c.E,{variant:"light",color:e.localOnly?"orange":"green",size:"sm",children:e.localOnly?"本地":"已同步"}),(0,l.jsx)(c.E,{variant:"light",color:F(e.difficulty),size:"sm",children:O(e.difficulty)})]}),(0,l.jsxs)(x.a,{style:{flex:1},children:[(0,l.jsx)(n.h,{order:4,mb:"xs",children:e.title}),(0,l.jsx)(h.E,{size:"sm",c:"dimmed",mb:"sm",lineClamp:2,children:e.description}),(0,l.jsxs)(a.Y,{gap:"xs",mb:"sm",children:[e.totalTime&&(0,l.jsxs)(a.Y,{gap:"xs",children:[(0,l.jsx)(X.A,{size:14}),(0,l.jsx)(h.E,{size:"xs",c:"dimmed",children:e.totalTime})]}),e.steps&&(0,l.jsxs)(a.Y,{gap:"xs",children:[(0,l.jsx)(V.A,{size:14}),(0,l.jsxs)(h.E,{size:"xs",c:"dimmed",children:[e.steps.length," 步骤"]})]}),e.tools&&(0,l.jsxs)(a.Y,{gap:"xs",children:[(0,l.jsx)(Q.A,{size:14}),(0,l.jsxs)(h.E,{size:"xs",c:"dimmed",children:[e.tools.length," 工具"]})]})]})]}),(0,l.jsx)(W.c,{}),(0,l.jsxs)(a.Y,{justify:"space-between",children:[(0,l.jsxs)(a.Y,{gap:"xs",children:[(0,l.jsx)(L.M,{variant:"light",size:"sm",onClick:()=>{m(e),z(!0),null==s||s(e)},children:(0,l.jsx)(ee.A,{size:14})}),(0,l.jsx)(L.M,{variant:"light",size:"sm",onClick:()=>{},children:(0,l.jsx)(es.A,{size:14})}),e.localOnly&&(0,l.jsx)(L.M,{variant:"light",color:"blue",size:"sm",onClick:()=>{console.log("Sync to server:",e.id)},children:(0,l.jsx)(ei.A,{size:14})})]}),(0,l.jsx)(L.M,{variant:"light",color:"red",size:"sm",onClick:()=>u(e.id),children:(0,l.jsx)(el.A,{size:14})})]})]})})},e.id))}),(0,l.jsx)(M.a,{opened:f,onClose:()=>p(!1),title:"创建流程设计",size:"lg",children:(0,l.jsxs)(o.B,{gap:"md",children:[(0,l.jsx)(Z.k,{label:"流程标题",placeholder:"输入流程标题",value:S.title,onChange:e=>C({...S,title:e.target.value}),required:!0}),(0,l.jsx)(G.T,{label:"流程描述",placeholder:"描述这个流程的目的和概述",value:S.description,onChange:e=>C({...S,description:e.target.value}),minRows:3,required:!0}),(0,l.jsx)(J.l,{label:"难度等级",value:S.difficulty,onChange:e=>C({...S,difficulty:e}),data:[{value:"easy",label:"简单"},{value:"medium",label:"中等"},{value:"hard",label:"困难"}]}),(0,l.jsxs)(a.Y,{justify:"flex-end",mt:"md",children:[(0,l.jsx)(Y.$,{variant:"light",onClick:()=>p(!1),children:"取消"}),(0,l.jsx)(Y.$,{onClick:D,disabled:!S.title||!S.description,children:"创建"})]})]})}),(0,l.jsx)(M.a,{opened:w,onClose:()=>v(!1),title:"AI 辅助创建流程设计",size:"lg",children:(0,l.jsxs)(o.B,{gap:"md",children:[(0,l.jsx)(_.F,{color:"blue",variant:"light",children:(0,l.jsx)(h.E,{size:"sm",children:"AI 将根据您提供的信息自动生成详细的流程步骤和说明"})}),(0,l.jsx)(Z.k,{label:"流程标题",placeholder:"例如：网站开发完整流程",value:I.title,onChange:e=>N({...I,title:e.target.value}),required:!0}),(0,l.jsx)(G.T,{label:"流程描述",placeholder:"详细描述这个流程要解决的问题和目标",value:I.description,onChange:e=>N({...I,description:e.target.value}),minRows:3,required:!0}),(0,l.jsx)(G.T,{label:"具体目标",placeholder:"列出这个流程要达成的具体目标",value:I.goals,onChange:e=>N({...I,goals:e.target.value}),minRows:2}),(0,l.jsx)(Z.k,{label:"领域/行业",placeholder:"例如：软件开发、市场营销、项目管理",value:I.domain,onChange:e=>N({...I,domain:e.target.value})}),(0,l.jsx)(J.l,{label:"难度等级",value:I.difficulty,onChange:e=>N({...I,difficulty:e}),data:[{value:"easy",label:"简单"},{value:"medium",label:"中等"},{value:"hard",label:"困难"}]}),(0,l.jsx)(G.T,{label:"参考资料 (可选)",placeholder:"提供相关的网址、文档或其他参考资料",value:I.referenceUrls,onChange:e=>N({...I,referenceUrls:e.target.value}),minRows:2}),(0,l.jsxs)(a.Y,{justify:"flex-end",mt:"md",children:[(0,l.jsx)(Y.$,{variant:"light",onClick:()=>v(!1),children:"取消"}),(0,l.jsx)(Y.$,{onClick:R,disabled:!I.title||!I.description,loading:$,leftSection:(0,l.jsx)(y.A,{size:16}),children:"AI 生成流程"})]})]})}),(0,l.jsx)(M.a,{opened:b,onClose:()=>z(!1),title:(null==j?void 0:j.title)||"流程详情",size:"xl",children:j&&(0,l.jsxs)(o.B,{gap:"md",children:[(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(c.E,{color:F(j.difficulty),children:O(j.difficulty)}),j.totalTime&&(0,l.jsx)(c.E,{variant:"light",children:(0,l.jsxs)(a.Y,{gap:"xs",children:[(0,l.jsx)(X.A,{size:12}),j.totalTime]})})]}),(0,l.jsx)(h.E,{children:j.description}),j.article&&(0,l.jsx)(k.t,{p:"md",withBorder:!0,children:(0,l.jsx)(h.E,{size:"sm",style:{whiteSpace:"pre-wrap"},children:j.article})}),j.steps&&j.steps.length>0&&(0,l.jsxs)(x.a,{children:[(0,l.jsx)(n.h,{order:4,mb:"md",children:"流程步骤"}),(0,l.jsx)(H.K,{children:j.steps.map((e,s)=>(0,l.jsxs)(H.K.Item,{title:e.title,children:[(0,l.jsx)(h.E,{size:"sm",c:"dimmed",children:e.description}),e.estimatedTime&&(0,l.jsxs)(h.E,{size:"xs",c:"dimmed",mt:"xs",children:["预计时间: ",e.estimatedTime]})]},s))})]})]})})]})};var ea=i(8796);function en(){let[e,s]=(0,t.useState)("chat"),i=[{id:"chat",label:"聊天",icon:u.A,color:"blue"},{id:"knowledge",label:"框架",icon:j.A,color:"violet"},{id:"templates",label:"提示",icon:m.A,color:"green"},{id:"flows",label:"流程",icon:g.A,color:"teal"},{id:"apikeys",label:"密钥",icon:f.A,color:"orange"},{id:"settings",label:"设置",icon:p.A,color:"gray"},{id:"profile",label:"资料",icon:w.A,color:"pink"}];return(0,l.jsxs)(r.G,{header:{height:60},navbar:{width:140,breakpoint:"sm"},padding:0,children:[(0,l.jsx)(r.G.Header,{children:(0,l.jsxs)(a.Y,{h:"100%",px:"md",justify:"space-between",children:[(0,l.jsxs)(a.Y,{children:[(0,l.jsx)(y.A,{size:28,color:"#228be6"}),(0,l.jsx)(n.h,{order:3,c:"dark",children:"AI Desktop"})]}),(0,l.jsx)(c.E,{variant:"light",color:"blue",size:"sm",children:"v0.2.0"})]})}),(0,l.jsx)(r.G.Navbar,{p:"sm",className:"sidebar-nav",children:(0,l.jsxs)(o.B,{gap:"xs",children:[i.map(i=>{let t=i.icon;return(0,l.jsx)(d.k,{active:e===i.id,label:(0,l.jsx)(h.E,{size:"xs",fw:500,children:i.label}),leftSection:(0,l.jsx)(t,{size:18}),onClick:()=>s(i.id),variant:"filled",color:i.color,style:{borderRadius:"6px",minHeight:"36px",padding:"6px 8px"}},i.id)}),(0,l.jsx)(x.a,{mt:"auto",pt:"md",children:(0,l.jsx)(h.E,{size:"xs",c:"dimmed",ta:"center",children:"AI Desktop"})})]})}),(0,l.jsx)(r.G.Main,{className:"content-area",children:(()=>{switch(e){case"chat":default:return(0,l.jsx)(z.C,{});case"knowledge":return(0,l.jsx)(q.mq,{});case"templates":return(0,l.jsx)(ea.g,{});case"flows":return(0,l.jsx)(er,{});case"apikeys":return(0,l.jsx)(v.z,{});case"settings":return(0,l.jsx)(b.V,{});case"profile":return(0,l.jsx)(O,{})}})()})]})}},942:(e,s,i)=>{"use strict";function l(){let e=window;if(void 0!==e.__TAURI__||void 0!==e.__TAURI_INTERNALS__||window.navigator.userAgent.includes("Tauri"))return!0;try{if(e.location&&"tauri:"===e.location.protocol)return!0}catch(e){}return"file:"===window.location.protocol||"tauri:"===window.location.protocol}function t(){return{isTauri:l(),isDev:!1,isBuild:!0,userAgent:window.navigator.userAgent,platform:window.navigator.platform}}async function r(){if(l())return!0;try{let{invoke:e}=await i.e(379).then(i.bind(i,7379));if(e)return await e("greet"),!0}catch(e){console.warn("Tauri API test failed:",e)}return!1}async function a(){try{if(await r()){let{invoke:e}=await i.e(379).then(i.bind(i,7379)),{getCurrentWindow:s}=await i.e(381).then(i.bind(i,9381)),l=s();return{invoke:e,currentWindow:l}}}catch(e){console.warn("Failed to import Tauri API:",e)}return{invoke:null,currentWindow:null}}function n(){let e=t();console.log("\uD83D\uDD0D Environment Info:",e),e.isTauri?console.log("✅ Running in Tauri desktop app"):console.log("\uD83C\uDF10 Running in web browser")}i.d(s,{XI:()=>r,cR:()=>t,uL:()=>n,vo:()=>l,xU:()=>a})},1519:(e,s,i)=>{"use strict";i.d(s,{A:()=>r});var l=i(6354),t=i(942);let r=()=>{let[e,s]=(0,l.useState)(null),[i,r]=(0,l.useState)(!0),[a,n]=(0,l.useState)(!1),[c,o]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(0,t.uL)(),d()},[]);let d=async()=>{let e=await (0,t.XI)();o(e),console.log("\uD83D\uDD0D Tauri环境检测结果: ".concat(e?"✅ 是":"❌ 否")),await h()},h=async()=>{r(!0);try{let{invoke:e}=await (0,t.xU)();if(!c||!e){console.log("\uD83C\uDF10 Web环境：检查localStorage认证状态");let e=localStorage.getItem("auth_user"),i=localStorage.getItem("auth_token"),l=localStorage.getItem("auth_expires");if(e&&i&&l){let i=parseInt(l);if(Date.now()<i){let i=JSON.parse(e);s(i),n(!0),console.log("✅ Web环境：找到有效的认证数据")}else localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_expires"),console.log("⏰ Web环境：认证数据已过期，已清除")}else console.log("❌ Web环境：未找到认证数据");return}console.log("\uD83D\uDDA5️ Tauri环境：检查本地认证状态");let i=await e("get_auth_data");i?(s(i.user),n(!0),console.log("✅ Tauri环境：找到有效的认证数据")):console.log("❌ Tauri环境：未找到认证数据")}catch(e){console.error("❌ 检查认证状态失败:",e)}finally{r(!1)}},x=async()=>{try{let{invoke:e}=await (0,t.xU)();c&&e?(console.log("\uD83D\uDDA5️ Tauri环境：调用logout命令"),await e("logout")):(console.log("\uD83C\uDF10 Web环境：清除认证数据"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_expires"))}catch(e){console.error("❌ 登出失败:",e)}finally{s(null),n(!1),console.log("✅ 登出成功"),window.location.href="/login"}};return{user:e,isLoading:i,isAuthenticated:a,isTauriEnv:c,login:e=>{s(e),n(!0)},logout:x,checkAuthStatus:h}}},5458:(e,s,i)=>{Promise.resolve().then(i.bind(i,46))}},e=>{e.O(0,[315,155,57,634,387,867,559,955,198,854,162,358],()=>e(e.s=5458)),_N_E=e.O()}]);