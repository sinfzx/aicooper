(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5458:(e,s,t)=>{Promise.resolve().then(t.bind(t,8880))},8880:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(7770),l=t(6354);let r=e=>{let{variant:s="primary",size:t="md",className:l="",children:r,...i}=e,n="".concat("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500"}[s]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[t]," ").concat(l);return(0,a.jsx)("button",{className:n,...i,children:r})},i=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 ".concat(t),children:s})},n=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 ".concat(t),children:s})},c=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("div",{className:"px-6 py-4 ".concat(t),children:s})},d=async()=>{try{if(window.__TAURI__){let{invoke:e}=await t.e(379).then(t.bind(t,7379));return e}}catch(e){console.warn("Tauri API not available:",e)}return null},o=[{id:"openai",name:"OpenAI",description:"GPT-4, GPT-3.5 等模型",icon:"\uD83E\uDD16",models:[{id:"gpt-4",name:"GPT-4",contextLength:8192},{id:"gpt-4-turbo",name:"GPT-4 Turbo",contextLength:128e3},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",contextLength:4096}],requiredFields:[{key:"apiKey",label:"API Key",type:"password",required:!0,placeholder:"sk-..."},{key:"baseUrl",label:"Base URL (可选)",type:"url",required:!1,placeholder:"https://api.openai.com/v1"}]},{id:"anthropic",name:"Anthropic",description:"Claude 系列模型",icon:"\uD83E\uDDE0",models:[{id:"claude-3-opus-20240229",name:"Claude 3 Opus",contextLength:2e5},{id:"claude-3-sonnet-20240229",name:"Claude 3 Sonnet",contextLength:2e5},{id:"claude-3-haiku-20240307",name:"Claude 3 Haiku",contextLength:2e5}],requiredFields:[{key:"apiKey",label:"API Key",type:"password",required:!0,placeholder:"sk-ant-..."}]}],x=()=>{var e;let[s,t]=(0,l.useState)([]),[x,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)(null),[p,g]=(0,l.useState)({}),[j,y]=(0,l.useState)(!1),[b,f]=(0,l.useState)({}),[v,N]=(0,l.useState)(!1);(0,l.useEffect)(()=>{w()},[]);let w=async()=>{let e=await d();N(!!e),e&&k()},k=async()=>{try{let e=await d();if(!e)return void console.warn("Tauri API not available");let s=await e("get_api_keys");t(s)}catch(e){console.error("Failed to load API keys:",e)}},A=()=>{m(!0),u(null),g({})},I=(e,s)=>{g(t=>({...t,[e]:s}))},D=async()=>{if(h&&p.apiKey){y(!0);try{let e=await d();if(!e)return void alert("Tauri API 不可用，无法测试 API Key");let s=await e("test_api_key",{provider:h.id,apiKey:p.apiKey,baseUrl:p.baseUrl||null});f(e=>({...e,[h.id]:s})),s?alert("API Key 测试成功！"):alert("API Key 测试失败，请检查密钥是否正确。")}catch(e){console.error("API Key test failed:",e),alert("测试失败: ".concat(e))}finally{y(!1)}}},C=async()=>{var e;if(!h||!p.apiKey)return;let t=await d();if(!t)return void alert("Tauri API 不可用，无法保存 API Key");let a={id:Date.now().toString(),name:p.name||"".concat(h.name," Key"),provider:h.id,apiKey:p.apiKey,baseUrl:p.baseUrl||void 0,model:p.model||(null==(e=h.models[0])?void 0:e.id),isDefault:0===s.filter(e=>e.provider===h.id).length,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};try{await t("save_api_key",{apiKey:a}),await k(),m(!1),u(null),g({})}catch(e){console.error("Failed to save API key:",e),alert("保存失败: ".concat(e))}},S=async e=>{if(!confirm("确定要删除这个 API Key 吗？"))return;let s=await d();if(!s)return void alert("Tauri API 不可用，无法删除 API Key");try{await s("delete_api_key",{keyId:e}),await k()}catch(e){console.error("Failed to delete API key:",e),alert("删除失败: ".concat(e))}},P=async e=>{let s=await d();if(!s)return void alert("Tauri API 不可用，无法更新 API Key");let t={...e,isDefault:!e.isDefault,updatedAt:new Date().toISOString()};try{await s("save_api_key",{apiKey:t}),await k()}catch(e){console.error("Failed to update API key:",e)}};return v?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"API Key 管理"}),(0,a.jsx)("p",{className:"text-gray-600",children:"管理您的 AI 服务提供商 API 密钥"})]}),(0,a.jsx)(r,{onClick:A,variant:"primary",children:"添加 API Key"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:s.map(e=>{let s=o.find(s=>s.id===e.provider);return(0,a.jsxs)(i,{className:"relative",children:[(0,a.jsx)(n,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:(null==s?void 0:s.icon)||"\uD83D\uDD11"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:null==s?void 0:s.name})]})]}),e.isDefault&&(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"默认"})]})}),(0,a.jsxs)(c,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"API Key:"}),(0,a.jsxs)("span",{className:"font-mono",children:[e.apiKey.substring(0,8),"...",e.apiKey.slice(-4)]})]}),e.model&&(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"模型:"}),(0,a.jsx)("span",{children:e.model})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"状态:"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(e.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.isActive?"活跃":"禁用"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-4",children:[(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>P(e),className:"flex-1",children:e.isDefault?"取消默认":"设为默认"}),(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>S(e.id),className:"text-red-600 hover:text-red-700",children:"删除"})]})]})]},e.id)})}),x&&(0,a.jsxs)(i,{className:"mb-6",children:[(0,a.jsx)(n,{children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"添加新的 API Key"})}),(0,a.jsx)(c,{children:h?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)("span",{className:"text-2xl",children:h.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:h.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:h.description})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"配置名称"}),(0,a.jsx)("input",{type:"text",value:p.name||"",onChange:e=>I("name",e.target.value),placeholder:"".concat(h.name," 配置"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),h.requiredFields.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.label," ",e.required&&(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:e.type,value:p[e.key]||"",onChange:s=>I(e.key,s.target.value),placeholder:e.placeholder,required:e.required,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.description})]},e.key)),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"默认模型"}),(0,a.jsx)("select",{value:p.model||(null==(e=h.models[0])?void 0:e.id)||"",onChange:e=>I("model",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:h.models.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)(r,{onClick:D,variant:"outline",disabled:!p.apiKey||j,children:j?"测试中...":"测试连接"}),(0,a.jsx)(r,{onClick:C,variant:"primary",disabled:!p.apiKey,children:"保存"}),(0,a.jsx)(r,{onClick:()=>{m(!1),u(null),g({})},variant:"outline",children:"取消"})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"选择 AI 服务提供商："}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map(e=>(0,a.jsx)("div",{onClick:()=>{u(e),g({})},className:"p-4 border rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]})},e.id))})]})})]}),0===s.length&&!x&&(0,a.jsx)(i,{children:(0,a.jsxs)(c,{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD11"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"还没有 API Key"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"添加您的第一个 AI 服务提供商 API Key 来开始使用"}),(0,a.jsx)(r,{onClick:A,variant:"primary",children:"添加 API Key"})]})})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(i,{children:(0,a.jsxs)(c,{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF10"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Web 预览模式"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"API Key 管理功能需要在 Tauri 桌面应用中使用。"}),(0,a.jsx)(r,{variant:"primary",onClick:()=>window.location.reload(),children:"刷新页面"})]})})})},m=async()=>{try{if(window.__TAURI__){let{invoke:e}=await t.e(379).then(t.bind(t,7379));return e}}catch(e){console.warn("Tauri API not available:",e)}return null},h=()=>{let[e,s]=(0,l.useState)({theme:"system",language:"zh-CN",autoSave:!0,defaultProvider:"",maxTokens:4e3,temperature:.7,enableTelemetry:!1}),[t,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(!1),[h,u]=(0,l.useState)(!1);(0,l.useEffect)(()=>{p()},[]);let p=async()=>{let e=await m();u(!!e),e&&g()},g=async()=>{try{let e=await m();if(!e)return void console.warn("Tauri API not available, using default settings");let t=await e("get_settings");s(t)}catch(e){console.error("Failed to load settings:",e)}},j=async()=>{let s=await m();if(!s)return void alert("Tauri API 不可用，无法保存设置");d(!0);try{await s("save_settings",{settings:e}),x(!0),setTimeout(()=>x(!1),2e3)}catch(e){console.error("Failed to save settings:",e),alert("保存失败: ".concat(e))}finally{d(!1)}},y=(e,t)=>{s(s=>({...s,[e]:t}))};return h?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"应用设置"}),(0,a.jsx)("p",{className:"text-gray-600",children:"自定义您的应用体验"})]}),(0,a.jsx)(r,{onClick:j,variant:"primary",disabled:t,children:t?"保存中...":o?"已保存":"保存设置"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i,{children:[(0,a.jsx)(n,{children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"外观"})}),(0,a.jsxs)(c,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"主题"}),(0,a.jsxs)("select",{value:e.theme,onChange:e=>y("theme",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"light",children:"浅色"}),(0,a.jsx)("option",{value:"dark",children:"深色"}),(0,a.jsx)("option",{value:"system",children:"跟随系统"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"语言"}),(0,a.jsxs)("select",{value:e.language,onChange:e=>y("language",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"zh-CN",children:"简体中文"}),(0,a.jsx)("option",{value:"en-US",children:"English"})]})]})]})]}),(0,a.jsxs)(i,{children:[(0,a.jsx)(n,{children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"AI 配置"})}),(0,a.jsxs)(c,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"最大 Token 数量"}),(0,a.jsx)("input",{type:"number",min:"100",max:"32000",value:e.maxTokens,onChange:e=>y("maxTokens",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"控制 AI 响应的最大长度，较高的值会消耗更多 token"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["温度 (Temperature): ",e.temperature]}),(0,a.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:e.temperature,onChange:e=>y("temperature",parseFloat(e.target.value)),className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,a.jsx)("span",{children:"更保守 (0.0)"}),(0,a.jsx)("span",{children:"更创造性 (2.0)"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"控制 AI 响应的随机性和创造性"})]})]})]}),(0,a.jsxs)(i,{children:[(0,a.jsx)(n,{children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"行为"})}),(0,a.jsxs)(c,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"自动保存"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"自动保存聊天记录和设置"})]}),(0,a.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.autoSave,onChange:e=>y("autoSave",e.target.checked),className:"sr-only peer"}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"启用遥测"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"帮助改进应用体验（匿名数据）"})]}),(0,a.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.enableTelemetry,onChange:e=>y("enableTelemetry",e.target.checked),className:"sr-only peer"}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,a.jsxs)(i,{children:[(0,a.jsx)(n,{children:(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"数据管理"})}),(0,a.jsxs)(c,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"导出数据"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"导出您的聊天记录和设置"})]}),(0,a.jsx)(r,{variant:"outline",size:"sm",children:"导出"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"导入数据"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"从备份文件恢复数据"})]}),(0,a.jsx)(r,{variant:"outline",size:"sm",children:"导入"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-red-700",children:"清除所有数据"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"删除所有聊天记录、API Key 和设置"})]}),(0,a.jsx)(r,{variant:"outline",size:"sm",className:"text-red-600 border-red-600 hover:bg-red-50",onClick:()=>{confirm("确定要清除所有数据吗？此操作不可恢复！")&&alert("功能开发中...")},children:"清除"})]})]})]})]})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(i,{children:(0,a.jsxs)(c,{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF10"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Web 预览模式"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"设置管理功能需要在 Tauri 桌面应用中使用。"}),(0,a.jsx)(r,{variant:"primary",onClick:()=>window.location.reload(),children:"刷新页面"})]})})})},u=async()=>{try{if(window.__TAURI__){let{invoke:e}=await t.e(379).then(t.bind(t,7379));return e}}catch(e){console.warn("Tauri API not available:",e)}return null},p=()=>{let[e,s]=(0,l.useState)([]),[t,n]=(0,l.useState)(null),[d,o]=(0,l.useState)([]),[x,m]=(0,l.useState)(""),[h,p]=(0,l.useState)(!1),[g,j]=(0,l.useState)(!1),y=(0,l.useRef)(null);(0,l.useEffect)(()=>{b()},[]);let b=async()=>{let e=await u();j(!!e),e&&f()};(0,l.useEffect)(()=>{v()},[d]);let f=async()=>{try{let e=await u();if(!e){console.warn("Tauri API not available, using mock data");let e=[{id:"mock-1",name:"Mock OpenAI",provider:"openai",apiKey:"mock-key",baseUrl:void 0,model:"gpt-3.5-turbo",isDefault:!0,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}];s(e),n(e[0]);return}let t=await e("get_api_keys");s(t);let a=t.find(e=>e.isDefault&&e.isActive);a?n(a):t.length>0&&n(t[0])}catch(e){console.error("Failed to load API keys:",e)}},v=()=>{var e;null==(e=y.current)||e.scrollIntoView({behavior:"smooth"})},N=async()=>{if(!x.trim()||!t||h)return;let e={id:Date.now().toString(),role:"user",content:x.trim(),timestamp:new Date().toISOString()};o(s=>[...s,e]),m(""),p(!0);try{let s,a=await u();if(a){let l=[...d,e].map(e=>({role:e.role,content:e.content}));s=await a("chat_with_ai",{provider:t.provider,apiKey:t.apiKey,model:t.model||"gpt-3.5-turbo",messages:l,baseUrl:t.baseUrl||null})}else await new Promise(e=>setTimeout(e,1e3)),s='这是一个模拟回复，因为 Tauri API 不可用。您的消息是："'.concat(e.content,'"');let l={id:(Date.now()+1).toString(),role:"assistant",content:s,timestamp:new Date().toISOString(),model:t.model};o(e=>[...e,l])}catch(s){console.error("Chat failed:",s);let e={id:(Date.now()+1).toString(),role:"assistant",content:"抱歉，发生了错误：".concat(s),timestamp:new Date().toISOString()};o(s=>[...s,e])}finally{p(!1)}};return g?0===e.length?(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(i,{children:(0,a.jsxs)(c,{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83E\uDD16"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"需要配置 API Key"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"请先在 API Key 管理页面添加至少一个 AI 服务提供商的密钥"}),(0,a.jsx)(r,{variant:"primary",children:"前往配置"})]})})}):(0,a.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"AI 聊天"}),(0,a.jsx)("select",{value:(null==t?void 0:t.id)||"",onChange:s=>{n(e.find(e=>e.id===s.target.value)||null)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:e.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.provider,")"]},e.id))})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>{confirm("确定要清除聊天记录吗？")&&o([])},children:"清除聊天"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50",children:0===d.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCAC"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"开始对话"}),(0,a.jsx)("p",{className:"text-gray-600",children:"向 AI 提问任何问题，开始您的智能对话"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[d.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[70%] p-3 rounded-lg ".concat("user"===e.role?"bg-blue-600 text-white":"bg-white border shadow-sm"),children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap",children:e.content}),(0,a.jsxs)("div",{className:"text-xs mt-2 ".concat("user"===e.role?"text-blue-100":"text-gray-500"),children:[new Date(e.timestamp).toLocaleTimeString(),e.model&&" • ".concat(e.model)]})]})},e.id)),h&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-white border shadow-sm p-3 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"text-gray-500",children:"AI 正在思考..."})]})})}),(0,a.jsx)("div",{ref:y})]})}),(0,a.jsxs)("div",{className:"p-4 border-t bg-white",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("textarea",{value:x,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N())},placeholder:"输入您的消息... (Shift+Enter 换行，Enter 发送)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:1,style:{minHeight:"40px",maxHeight:"120px"},onInput:e=>{let s=e.target;s.style.height="auto",s.style.height=Math.min(s.scrollHeight,120)+"px"}}),(0,a.jsx)(r,{onClick:N,disabled:!x.trim()||!t||h,variant:"primary",children:"发送"})]}),t&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["使用 ",t.name," (",t.model||"default",")"]})]})]}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(i,{children:(0,a.jsxs)(c,{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF10"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Web 预览模式"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"当前运行在 Web 环境中，部分功能可能不可用。请在 Tauri 桌面应用中使用完整功能。"}),(0,a.jsx)(r,{variant:"primary",onClick:()=>window.location.reload(),children:"刷新页面"})]})})})},g=[{id:1,title:"文章写作助手",description:"帮助您创作高质量的文章内容",category:"写作",template:"请帮我写一篇关于 {主题} 的文章，要求：\n1. 结构清晰，逻辑严谨\n2. 内容深入，观点独特\n3. 语言流畅，易于理解\n4. 字数控制在 {字数} 字左右"},{id:2,title:"代码审查专家",description:"专业的代码审查和优化建议",category:"编程",template:"请审查以下代码并提供改进建议：\n\n```{编程语言}\n{代码内容}\n```\n\n请从以下角度分析：\n1. 代码质量和可读性\n2. 性能优化建议\n3. 安全性考虑\n4. 最佳实践建议"},{id:3,title:"数据分析师",description:"专业的数据分析和洞察提取",category:"分析",template:"请分析以下数据并提供洞察：\n\n{数据描述}\n\n分析要求：\n1. 识别关键趋势和模式\n2. 提供数据驱动的洞察\n3. 给出可行的建议\n4. 用图表或可视化方式展示结果"},{id:4,title:"翻译专家",description:"专业的多语言翻译服务",category:"翻译",template:"请将以下内容从 {源语言} 翻译成 {目标语言}，要求：\n1. 准确传达原文意思\n2. 符合目标语言表达习惯\n3. 保持原文的语气和风格\n\n原文：\n{待翻译内容}"},{id:5,title:"学习助手",description:"帮助理解和学习复杂概念",category:"教育",template:"请帮我理解 {概念/主题}，要求：\n1. 用简单易懂的语言解释\n2. 提供具体的例子\n3. 指出重点和难点\n4. 给出学习建议\n\n我的背景：{学习背景}"}],j=()=>{let[e,s]=(0,l.useState)("全部"),[t,d]=(0,l.useState)(""),o=g.filter(s=>{let a="全部"===e||s.category===e,l=s.title.toLowerCase().includes(t.toLowerCase())||s.description.toLowerCase().includes(t.toLowerCase());return a&&l});return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,a.jsxs)("div",{className:"p-6 border-b",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"\uD83D\uDCDD 提示词模板"}),(0,a.jsx)("p",{className:"text-gray-600",children:"使用专业的提示词模板，快速生成高质量的 AI 对话"})]}),(0,a.jsx)("div",{className:"p-6 border-b bg-gray-50",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"搜索模板...",value:t,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),(0,a.jsx)("div",{className:"flex gap-2 flex-wrap",children:["全部","写作","编程","分析","翻译","教育"].map(t=>(0,a.jsx)("button",{onClick:()=>s(t),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(e===t?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:t},t))})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:0===o.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\uD83D\uDD0D"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"没有找到匹配的模板"}),(0,a.jsx)("p",{className:"text-gray-500",children:"尝试调整搜索条件或选择不同的分类"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>(0,a.jsxs)(i,{className:"hover:shadow-lg transition-shadow",children:[(0,a.jsx)(n,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e.category})]})}),(0,a.jsxs)(c,{children:[(0,a.jsx)("div",{className:"bg-gray-50 p-3 rounded text-sm text-gray-700 mb-4 max-h-32 overflow-y-auto",children:e.template}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r,{variant:"primary",size:"sm",className:"flex-1",onClick:()=>{navigator.clipboard.writeText(e.template),alert("模板已复制到剪贴板")},children:"复制模板"}),(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>{console.log("使用模板:",e.template)},children:"使用"})]})]})]},e.id))})})]})},y=[{id:"1",title:"办公效率",description:"提升工作效率的系统性方法",expanded:!1,questions:["如何制定有效的工作计划？","什么是时间管理的核心原则？","如何提高团队协作效率？"],children:[{id:"1-1",title:"时间管理",description:"科学管理时间，提高工作效率",expanded:!1,questions:["如何使用番茄工作法？","什么是时间块管理？","如何处理时间碎片？"],children:[]},{id:"1-2",title:"沟通技巧",description:"有效沟通的方法和技巧",expanded:!1,questions:["如何进行有效的会议？","怎样写出清晰的邮件？","如何处理工作冲突？"],children:[]}]},{id:"2",title:"数字营销",description:"数字化时代的营销策略和方法",expanded:!1,questions:["什么是数字营销的核心？","如何制定营销策略？","怎样衡量营销效果？"],children:[{id:"2-1",title:"内容营销",description:"通过优质内容吸引和转化客户",expanded:!1,questions:["如何创作吸引人的内容？","什么是内容营销漏斗？","如何分发内容？"],children:[]},{id:"2-2",title:"SEO优化",description:"搜索引擎优化的策略和技巧",expanded:!1,questions:["什么是关键词研究？","如何优化网站结构？","怎样建设外链？"],children:[]}]}],b=e=>{let{node:s,level:t,onToggle:l,onShowQuestions:i}=e,n=s.children.length>0;return(0,a.jsxs)("div",{style:{marginLeft:"".concat(20*t,"px")},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded",children:[n&&(0,a.jsx)("button",{onClick:()=>l(s.id),className:"w-4 h-4 flex items-center justify-center text-gray-500 hover:text-gray-700",children:s.expanded?"\uD83D\uDCC2":"\uD83D\uDCC1"}),!n&&(0,a.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:"\uD83D\uDCC4"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:s.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:s.description})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>i(s),className:"text-xs",children:"显示问题"}),n&&(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>{alert("AI扩展功能开发中...")},className:"text-xs",children:"AI扩展"})]})]}),s.expanded&&s.children.map(e=>(0,a.jsx)(b,{node:e,level:t+1,onToggle:l,onShowQuestions:i},e.id))]})},f=()=>{let[e,s]=(0,l.useState)(y),[t,d]=(0,l.useState)(null),[o,x]=(0,l.useState)(!1),m=t=>{let a=e=>e.map(e=>e.id===t?{...e,expanded:!e.expanded}:e.children.length>0?{...e,children:a(e.children)}:e);s(a(e))},h=e=>{d(e),x(!0)};return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,a.jsxs)("div",{className:"p-6 border-b",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"\uD83E\uDDE0 知识框架"}),(0,a.jsx)("p",{className:"text-gray-600",children:"系统性的知识管理，帮助您构建完整的知识体系"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)(i,{className:"overflow-hidden",children:[(0,a.jsxs)(n,{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600",children:e.description})]}),(0,a.jsx)(c,{children:(0,a.jsx)(b,{node:e,level:0,onToggle:m,onShowQuestions:h})})]},e.id))})}),o&&t&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:[t.title," - 相关问题"]}),(0,a.jsx)("button",{onClick:()=>x(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"\xd7"})]}),(0,a.jsx)("div",{className:"space-y-3",children:t.questions.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"text-gray-800",children:e}),(0,a.jsx)(r,{variant:"outline",size:"sm",onClick:()=>(e=>{let s="https://www.google.com/search?q=".concat(encodeURIComponent(e));window.open(s,"_blank")})(e),className:"ml-2",children:"\uD83D\uDD0D 搜索"})]},s))}),(0,a.jsx)("div",{className:"flex justify-end mt-6",children:(0,a.jsx)(r,{variant:"outline",onClick:()=>x(!1),children:"关闭"})})]})})})]})};function v(){let[e,s]=(0,l.useState)("chat");return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"w-64 bg-white shadow-sm border-r",children:[(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"AI Platform"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"桌面版"})]}),(0,a.jsx)("nav",{className:"mt-4",children:[{id:"chat",label:"\uD83D\uDCAC AI 聊天",icon:"\uD83D\uDCAC"},{id:"templates",label:"\uD83D\uDCDD 提示词模板",icon:"\uD83D\uDCDD"},{id:"knowledge",label:"\uD83E\uDDE0 知识框架",icon:"\uD83E\uDDE0"},{id:"apikeys",label:"\uD83D\uDD11 API 密钥",icon:"\uD83D\uDD11"},{id:"settings",label:"⚙️ 设置",icon:"⚙️"}].map(t=>(0,a.jsxs)("button",{onClick:()=>s(t.id),className:"w-full flex items-center px-4 py-3 text-left hover:bg-gray-50 transition-colors ".concat(e===t.id?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700"),children:[(0,a.jsx)("span",{className:"text-lg mr-3",children:t.icon}),(0,a.jsx)("span",{className:"font-medium",children:t.label.replace(/^.+ /,"")})]},t.id))}),(0,a.jsx)("div",{className:"absolute bottom-4 left-4 right-4",children:(0,a.jsxs)("div",{className:"text-xs text-gray-500 text-center",children:[(0,a.jsx)("p",{children:"AI Platform Desktop"}),(0,a.jsx)("p",{children:"v0.2.0"})]})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(()=>{switch(e){case"chat":default:return(0,a.jsx)(p,{});case"templates":return(0,a.jsx)(j,{});case"knowledge":return(0,a.jsx)(f,{});case"apikeys":return(0,a.jsx)(x,{});case"settings":return(0,a.jsx)(h,{})}})()})]})}}},e=>{e.O(0,[854,162,358],()=>e(e.s=5458)),_N_E=e.O()}]);